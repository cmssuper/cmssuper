(function(t){function e(e){for(var a,r,o=e[0],n=e[1],c=e[2],d=0,m=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&m.push(i[r][0]),i[r]=0;for(a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a]);u&&u(e);while(m.length)m.shift()();return l.push.apply(l,c||[]),s()}function s(){for(var t,e=0;e<l.length;e++){for(var s=l[e],a=!0,o=1;o<s.length;o++){var n=s[o];0!==i[n]&&(a=!1)}a&&(l.splice(e--,1),t=r(r.s=s[0]))}return t}var a={},i={app:0},l=[];function r(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=a,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(s,a,function(e){return t[e]}.bind(null,a));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/templates/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],n=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=n;l.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},1:function(t,e){},2078:function(t,e,s){"use strict";s("b430")},"3e62":function(t,e,s){"use strict";s("4b43")},"4b43":function(t,e,s){},"530c":function(t,e,s){"use strict";s("77ba")},"56d7":function(t,e,s){"use strict";s.r(e);s("ee3b");var a=s("364f"),i=function(){var t=this,e=t._self._c;return e("div",{class:t.$store.state.pageLoading?"skeleton-loading":"",attrs:{id:"app"}},["/"!=this.$route.path?e("PageHeader"):t._e(),e("router-view"),e("PageFooter")],1)},l=[],r=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header cl"},[e("div",{staticClass:"logo cl"},[e("router-link",{attrs:{to:"/home"}},[e("img",{attrs:{src:t.$baseHost+"/static/common/images/cmssuper.png"}})])],1),e("div",{staticClass:"menu cl"},[e("div",{staticClass:"menulist"},[e("el-menu",{attrs:{"default-active":t.$route.path,mode:"horizontal","background-color":"#EEF0F3",router:!0}},[t._l(t.headMenu,(function(s,a){return["string"==typeof s?e("el-menu-item",{key:a,attrs:{index:s}},[t._v(t._s(a))]):e("el-submenu",{key:a,attrs:{index:a,"show-timeout":0,"hide-timeout":0}},[e("template",{attrs:{index:a},slot:"title"},[t._v(t._s(a))]),t._l(s,(function(s,a){return["string"==typeof s?e("el-menu-item",{key:a,attrs:{index:s}},[t._v(t._s(a))]):e("el-submenu",{key:a,attrs:{index:a,"show-timeout":0,"hide-timeout":0}},[e("template",{slot:"title"},[t._v(t._s(a))]),t._l(s,(function(s,a){return[e("el-menu-item",{key:s,attrs:{index:s}},[t._v(t._s(a))])]}))],2)]}))],2)]}))],2)],1)]),e("div",{staticClass:"user-info cl"},[e("ul",[e("li",[e("a",{attrs:{href:"javascript:void(0);"},on:{click:t.fullScreen}},[e("span",{staticClass:"el-icon-s-platform"}),t._v(" 全屏")])]),t._m(0),e("li",[t.$store.state.common.user?e("el-dropdown",[e("router-link",{attrs:{to:"/admin"}},[t._v(t._s(t.$store.state.common.user.username)),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",[e("router-link",{staticStyle:{display:"block"},attrs:{to:"/admin"}},[t._v("管理员")])],1),e("el-dropdown-item",[e("router-link",{staticStyle:{display:"block"},attrs:{to:"/admin/edit?id="+t.$store.state.common.user.id}},[t._v("修改密码")])],1),e("el-dropdown-item",[e("div",{on:{click:t.logout}},[t._v("退出")])])],1)],1):t._e()],1)])])]),e("div",{staticClass:"left-menu"},[e("div",{staticClass:"menu-title"},[e("div",{staticClass:"mwrap"},[e("div",[t.sites[t.siteId]?e("a",{attrs:{href:"http://"+t.sites[t.siteId].name,target:"_blank"}},[e("i",{staticClass:"el-icon-link"}),t._v(" "+t._s(t.sites[t.siteId].sitename))]):e("router-link",{attrs:{to:"/sites/edit"}},[t._v("还没有站点")])],1),t._m(1)])]),e("div",{staticClass:"sitesearch"},[e("el-autocomplete",{staticStyle:{width:"184px"},attrs:{size:"mini","prefix-icon":"el-icon-search","fetch-suggestions":t.siteSearchAsync,placeholder:"搜索站点"},on:{select:t.suggestionsSiteSelect},model:{value:t.siteSearchValue,callback:function(e){t.siteSearchValue=e},expression:"siteSearchValue"}})],1),e("div",{staticClass:"left-menu-list"},[e("ul",t._l(t.sitesList,(function(s,a){return e("li",{key:a,class:t.siteId==s.id?"cur":"",on:{click:function(e){return t.changeSiteId(s.id)}}},[e("div",[e("div",{staticClass:"sitename"},[t._v(t._s(s.sitename))]),e("div",{staticClass:"siteDomain"},[t._v(t._s(s.name))])]),e("i",{staticClass:"el-icon-success"})])})),0)]),e("div",{staticClass:"menu-footer"},[e("div",{staticClass:"fwrap"},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.$router.push("/sites")}}},[t._v("管理 ")]),e("el-dropdown",{attrs:{"split-button":"",type:"primary",size:"mini",trigger:"click"},on:{click:function(e){return t.siteAdd("single")},command:t.siteAdd}},[t._v(" 添加站点 "),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"single"}},[t._v("单个添加")]),e("el-dropdown-item",{attrs:{command:"multi"}},[t._v("批量添加")])],1)],1)],1)])])])},o=[function(){var t=this,e=t._self._c;return e("li",[e("a",{attrs:{href:"https://support.qq.com/products/417911/",target:"_blank"}},[e("span",{staticClass:"el-icon-s-help"}),t._v(" 帮助")])])},function(){var t=this,e=t._self._c;return e("div",[e("i",{staticClass:"el-icon-arrow-right"}),t._v(" ")])}],n={name:"PageHeader",props:{},created(){localStorage.siteId&&this.changeSiteId(localStorage.siteId)},data(){return{headMenu:{"系统首页":"/home","内容管理":{"文章管理":"/article","栏目管理":"/classlist","采集管理":{"规则采集":"/crawler?tab=crawlRule","关键词采集":"/crawler?tab=crawlKeyword","AI采集":"/crawler?tab=AiNews"}},"搜索优化":{"关键词优化":"/seo/keyword","词语替换":"/seo/reword"},"其他管理":{"广告管理":"/ads","友情链接":"/flink","爬虫统计":"/spider"},"系统设置":{"系统配置":"/system/config","模版风格":"/theme","数据库管理":"/database"}},isFullScreen:!1,siteSearchValue:""}},computed:{sites(){return this.$store.getters.sites},sitesList(){return this.$store.getters.sitesList},siteId(){return this.$store.getters.siteId}},methods:{changeSiteId(t){this.$store.dispatch("setSiteId",t)},suggestionsSiteSelect(t){this.changeSiteId(t.id),this.siteSearchValue=""},siteAdd(t){"single"==t?this.$router.push("/sites/edit"):this.$router.push("/sites/edit?tab=multi")},siteSearchAsync(t,e){let s=[];for(var a in this.sites){var i=this.sites[a].name+this.sites[a].sitename;i.toLowerCase().indexOf(t.toLowerCase())>=0&&s.push({value:this.sites[a].name+this.sites[a].sitename,...this.sites[a]})}e(s)},fullScreen(){if(this.isFullScreen=!this.isFullScreen){var t=document.documentElement;t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}else document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},logout(){this.$axios.post("/?a=logout").then(()=>{this.$router.push("/")})}}},c=n,u=(s("9ad7"),s("cf15")),d=Object(u["a"])(c,r,o,!1,null,"b0d4e328",null),m=d.exports,p=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"footer"},[e("p",[e("b",[t._v("cms"),e("font",{attrs:{color:"#F77925"}},[t._v("Super")])],1),t._v(" - 简单建网站，站群也轻松 ")])])])},h=[],f={name:"PageHeader",props:{},methods:{}},b=f,g=(s("3e62"),Object(u["a"])(b,p,h,!1,null,"7af7bfc9",null)),v=g.exports,w={name:"App",components:{PageHeader:m,PageFooter:v},data(){return{}},created(){window.require.config({paths:{vs:"https://cdn.staticfile.org/monaco-editor/0.20.0/min/vs"},"vs/nls":{availableLanguages:{"*":"zh-cn"}}}),window.require(["https://cdn.staticfile.org/monaco-editor/0.20.0/min/vs/editor/editor.main.js"],()=>{})},methods:{loadJs(t){return new Promise(e=>{const s=document.createElement("script");s.type="text/javascript",s.src=t,s.onload=()=>{e()},document.body.appendChild(s)})}}},y=w,_=(s("c7c7"),Object(u["a"])(y,i,l,!1,null,null,null)),k=_.exports,x=s("5e61"),C=s.n(x),S=(s("f69b"),s("2e29")),$=s.n(S),T=s("c4bd"),A=s.n(T),I=s("8a6c");a["default"].use(I["a"]);var z=new I["a"].Store({state:{axiosLoading:!1,pageLoading:!0,common:{},_token:null,_siteId:null},getters:{token:t=>(!t._token&&localStorage.token&&(t._token=localStorage.token),t._token),sites:t=>t.common.sites?t.common.sites:{},sitesList:t=>{let e=t.common.sites?t.common.sites:[],s=[];for(var a in e)s.push(e[a]);return s.sort((function(t,e){return t.id<e.id?1:-1})),s},siteId:(t,e)=>{if(e.sitesList.length>0){if(t._siteId||(t._siteId=localStorage.siteId),t._siteId&&e.sites[t._siteId])return t._siteId;{let t=e.sitesList[0].id;return localStorage.setItem("siteId",t),t}}return 0}},mutations:{setAxiosLoading(t,e){t.axiosLoading=e},setPageLoading(t,e){t.pageLoading=e},setCommon(t,e){t.common=e},setToken(t,e){t._token=e},setSiteId(t,e){t._siteId=e}},actions:{setSiteId({commit:t,getters:e},s){e.sites[s]&&(localStorage.setItem("siteId",s),t("setSiteId",s))}},modules:{}}),D=s("47e4"),F=function(){var t=this,e=t._self._c;return e("div",{staticClass:"login"},[e("div",{staticClass:"mbox"},[e("el-carousel",{staticStyle:{width:"480px",height:"300px"},attrs:{direction:"vertical",autoplay:!0}},t._l(t.loginads,(function(t,s){return e("el-carousel-item",{key:s},[e("a",{attrs:{href:t.href,target:"_blank"}},[e("img",{attrs:{src:t.src,width:"480",height:"300"}})])])})),1),e("el-form",{ref:"form",attrs:{"label-width":"100px"}},[e("div",{staticClass:"logo"},[e("img",{attrs:{src:t.$baseHost+"/static/common/images/cmssuper.png",width:"200",height:"60"}})]),e("el-form-item",{attrs:{label:"管理员账号"}},[e("el-input",{nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitForm.apply(null,arguments)}},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),e("el-form-item",{attrs:{label:"登陆密码"}},[e("el-input",{attrs:{type:"password","show-password":""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitForm.apply(null,arguments)}},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(e){return t.submitForm()}}},[t._v("登陆后台")])],1)],1)],1)])},R=[],j={data:function(){return{}},computed:{...Object(I["c"])(["common","axiosLoading"]),...Object(I["b"])(["token","sites","sitesList","siteId"]),page(){return this.$route.query.page?parseInt(this.$route.query.page):1}},async mounted(){"/"!=this.$route.path&&await this.loadCommon();let t=["/","/home","/sites/edit"];if(0==this.sitesList.length&&!t.includes(this.$route.path))return this.$message.error("站群还没有添加网站，请先创建网站"),void this.$router.push("/sites/edit");this.pageInit&&(this.$store.commit("setPageLoading",!0),await this.pageInit(),this.$store.commit("setPageLoading",!1))},watch:{$route:{handler:function(){this.pageInit()},deep:!0},siteId(t,e){0!=e&&this.pageInit()}},methods:{loadCommon(t){return new Promise(e=>{!t&&this.common.user?e():this.$axios.post("?m=getCommon",{siteId:null}).then(t=>{t.data.success&&(this.$store.commit("setCommon",t.data.success),e())})})},routerTo(t,e){this.$router.push({path:t,query:e})},routerUpdate(t){let e=!1,s={...this.$route.query,...t};for(var a in t)if(null==t[a]&&delete s[a],t[a]!=this.$route.query[a]){e=!0;break}e&&this.$router.push({query:s})},formatTime(t){var e=new Date(1e3*t),s=e.getFullYear(),a=e.getMonth()+1,i=e.getDate(),l=e.getHours(),r=e.getMinutes(),o=e.getSeconds();return s+"-"+a+"-"+i+" "+l+":"+r+":"+o},formatSize(t){if(!-t)return"0B";var e=new Array("B","KB","MB","GB","TB","PB","EB","ZB","YB"),s=0,a=parseFloat(t);s=Math.floor(Math.log(a)/Math.log(1024));var i=a/Math.pow(1024,s);return i=parseFloat(i.toFixed(2)),i+e[s]},submitValidate(){return new Promise(t=>{this.$refs["form"].validate(e=>{t(e)})})},ajaxGet(t){this.$axios.get(t).then(t=>{t.data.success&&this.pageInit()})}}},P={mixins:[j],computed:{},data(){return{form:{},loginads:[{src:"https://ticcdn.com/cmssuper/ad/juming.png",href:"https://www.juming.com/?tt=124097"}]}},created(){},methods:{submitForm(){this.$axios.post("?a=login",this.form).then(t=>{t.data.success&&(this.$store.commit("setToken",t.data.success.token),localStorage.setItem("token",t.data.success.token),this.$router.replace({path:"/home"}))})}}},N=P,L=Object(u["a"])(N,F,R,!1,null,null,null),q=L.exports,O=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"dashboard"},[t.rewritetip?e("el-alert",{attrs:{title:"伪静态未设置完成，网站页面部分链接404，请检查服务器伪静态配置。",type:"warning",closable:!1}}):t._e(),e("div",{staticClass:"cl"},[e("div",{staticClass:"box"},[e("div",{staticClass:"box-title skeleton"},[t._v("数据总览")]),e("div",{staticClass:"box-content dataPreView"},[e("div",{staticClass:"dpanel skeleton"},[e("div",{staticClass:"line-top"},[e("p",{staticClass:"title"},[t._v("站点总数")]),e("p",{staticClass:"content"},[e("router-link",{attrs:{to:"/sites"}},[t._v(t._s(t.data.siteCount))])],1)]),e("div",{staticClass:"line-bottom"},[e("el-button",{on:{click:function(e){return t.routerTo("/sites/edit")}}},[t._v("创建站点")])],1)]),e("div",{staticClass:"dpanel skeleton"},[e("div",{staticClass:"line-top"},[e("p",{staticClass:"title"},[t._v("文章总数")]),e("p",{staticClass:"content"},[e("router-link",{attrs:{to:"/article"}},[t._v(t._s(t.data.newsCount))])],1)]),e("div",{staticClass:"line-bottom"},[e("el-button",{on:{click:function(e){return t.routerTo("/article/edit")}}},[t._v("发表文章")])],1)]),e("div",{staticClass:"dpanel skeleton"},[e("div",{staticClass:"line-top"},[e("p",{staticClass:"title"},[t._v("今日文章数")]),e("p",{staticClass:"content"},[t._v(t._s(t.data.todayCount))])]),e("div",{staticClass:"line-bottom"},[t._v("每日更新提高网站权重")])]),e("div",{staticClass:"dpanel skeleton"},[e("div",{staticClass:"line-top"},[e("p",{staticClass:"title"},[t._v("今日访问量")]),e("p",{staticClass:"content"},[t._v(t._s(t.data.visitCount))])]),e("div",{staticClass:"line-bottom"},[t._v("权重和流量会逐步提升")])]),e("div",{staticClass:"dpanel skeleton"},[e("div",{staticClass:"line-top"},[e("p",{staticClass:"title"},[t._v("今日爬虫抓取次数")]),e("p",{staticClass:"content"},[t._v(t._s(t.data.spiderCount))])]),e("div",{staticClass:"line-bottom"},[t._v("外链有助于增加爬虫量")])])])]),e("div",{staticClass:"box infobox",staticStyle:{"padding-top":"50px"}},[e("div",{staticClass:"sysbox"},[e("div",{staticClass:"box-title skeleton"},[t._v("系统信息")]),e("div",{staticClass:"box-content skeleton"},[e("div",[e("p",[e("span",[t._v("系统版本：")]),e("em",[t._v(t._s(t.data.softversion))]),t._v("   "),e("el-link",{attrs:{type:"primary"},on:{click:t.showUpdate}},[t._v("检测更新")])],1),e("p",[e("span",[t._v("剩余空间：")]),e("em",[t._v(t._s(t.formatSize(t.data.free_space)))])]),e("p",[e("span",[t._v("系统时间：")]),e("em",[t._v(t._s(t.data.systime))])]),t._m(0),t._m(1)])])])])])],1)])},B=[function(){var t=this,e=t._self._c;return e("p",[t._v(" 项目地址："),e("a",{attrs:{href:"https://github.com/thinkincloud/cmssuper",target:"_blank"}},[e("em",[t._v("https://github.com/thinkincloud/cmssuper")])])])},function(){var t=this,e=t._self._c;return e("p",[t._v(" 国内交流反馈："),e("a",{attrs:{href:"https://support.qq.com/products/417911/",target:"_blank"}},[e("em",[t._v("https://support.qq.com/products/417911/")])])])}],V=s("158b");const E=new V["a"]({id:417911});var U={mixins:[j],data(){return{data:{},rewritetip:!1,statsTimer:null}},methods:{async pageInit(){let t=await this.$axios.get("../systest").catch(t=>t);404==t.status&&(this.rewritetip=!0),t=await this.$axios.post("/?m=stats"),t.data.success&&(this.data=t.data.success),E.activateChangeLog()},showUpdate(){E.showModal()}}},H=U,M=(s("ac62"),Object(u["a"])(H,O,B,!1,null,"dde6900c",null)),G=M.exports,W=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[e("el-breadcrumb-item",[t._v("管理员列表")])],1)],1),e("div",{staticClass:"cp-table-top"},[e("el-button",{attrs:{size:"medium",type:"primary",plain:""},on:{click:function(e){return t.routerTo("/admin/edit")}}},[t._v("添加管理员 ")])],1),e("div",{staticClass:"cp-table skeleton"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.listData}},[e("el-table-column",{attrs:{prop:"username",label:"账号"}}),e("el-table-column",{attrs:{prop:"siteNum",label:"权限"},scopedSlots:t._u([{key:"default",fn:function(s){return[1==s.row.id?e("div",[t._v("超级管理员")]):e("div",[e("span",[t._v("管理")]),e("b",[t._v(t._s(s.row.siteNum))]),e("span",[t._v("站点")])])]}}])}),e("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(s){return[1==s.row.status?e("el-tag",{attrs:{type:"success",size:"small"}},[t._v("允许登陆")]):t._e(),0==s.row.status?e("el-tag",{attrs:{type:"info",size:"small"}},[t._v("禁止登陆")]):t._e()]}}])}),e("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(s){return t.common.user&&1==t.common.user.id?[e("div",{staticClass:"list-actions"},[e("span",[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.edit(s.row.id)}}},[t._v("修改")])],1),1!=s.row.id?e("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:function(e){return t.ajaxGet("?m=admin&a=del&id="+s.row.id)}}},[e("el-link",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v("删除")])],1):t._e()],1)]:void 0}}],null,!0)})],1)],1),e("div",{staticClass:"cp-pages"},[e("el-pagination",{attrs:{"current-page":t.page,"page-size":t.pagesize,"hide-on-single-page":!0,background:"",layout:"prev, pager, next",total:t.total},on:{"current-change":e=>{t.routerUpdate({page:e})}}})],1)])},K=[],Y={mixins:[j],data(){return{pagesize:20,total:0,listData:[]}},methods:{pageInit(){return new Promise(t=>{this.$axios.post("?m=admin",{pagesize:this.pagesize,page:this.page}).then(e=>{e.data.success&&(this.listData=e.data.success.list,this.total=parseInt(e.data.success.total),t())})})},edit(t){this.$router.push({path:"/admin/edit",query:{id:t}})}}},J=Y,Q=Object(u["a"])(J,W,K,!1,null,null,null),X=Q.exports,Z=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[e("el-breadcrumb-item",{attrs:{to:"/admin"}},[t._v("管理员列表")]),e("el-breadcrumb-item",[t.form.id?e("div",[t._v("修改管理员")]):e("div",[t._v("添加管理员")])])],1)],1),e("div",{staticClass:"cp-form"},[e("div",{staticClass:"box"},[e("el-form",{ref:"form",attrs:{model:t.form,"label-position":"top",size:"mini","label-width":"80px"}},[e("el-form-item",{staticClass:"skeleton",attrs:{label:"用户名"}},[e("el-input",{staticStyle:{width:"200px"},attrs:{disabled:!!t.form.id},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"登陆密码(不修改可留空)"}},[e("el-input",{staticStyle:{width:"200px"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"站点权限【测试功能，尚未开放】"}},[e("el-transfer",{attrs:{titles:["站点列表","已授权"],filterable:"","filter-method":t.filterMethod,"filter-placeholder":"站点搜索",data:t.sites},model:{value:t.form.siteids,callback:function(e){t.$set(t.form,"siteids",e)},expression:"form.siteids"}})],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"允许登陆"}},[e("el-switch",{attrs:{disabled:1==t.form.id||1!=t.adminId,"active-value":"1","inactive-value":"0"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}})],1),e("el-form-item",{staticClass:"skeleton"},[e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(e){return t.submitForm()}}},[t._v("保存")])],1)],1)],1)])])},tt=[],et={mixins:[j],data(){return{form:{}}},computed:{adminId:function(){return this.common.user?this.common.user.id:0},sites:function(){let t=[];for(var e in this.common.sites)t.push({key:this.common.sites[e].id,label:this.common.sites[e].name,name:this.common.sites[e].sitename,disabled:1==this.$route.query.id||1!=this.adminId});return t}},methods:{pageInit(){if(this.$route.query.id)return new Promise(t=>{this.$axios.get("?m=admin&a=edit&id="+this.$route.query.id).then(e=>{this.form=e.data.success,t()})})},filterMethod(t,e){var s=e.label+e.name;return s.indexOf(t)>-1},submitForm(){this.$axios.post("?m=admin&a=edit",this.form)}}},st=et,at=Object(u["a"])(st,Z,tt,!1,null,null,null),it=at.exports,lt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[e("el-breadcrumb-item",[t._v("广告管理")])],1)],1),e("div",{staticClass:"cp-table-top"},[e("el-button",{attrs:{size:"medium",type:"primary",plain:""},on:{click:function(e){return t.routerTo("/ads/edit")}}},[t._v("添加广告位 ")])],1),e("div",{staticClass:"cp-table skeleton"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.listData}},[e("el-table-column",{attrs:{prop:"id",label:"ID",width:"100"}}),e("el-table-column",{attrs:{prop:"title",label:"广告位名称"}}),e("el-table-column",{attrs:{prop:"abc",label:"调用代码"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("input",{staticStyle:{border:"0px",padding:"8px",background:"#f1f3f6",width:"90%","max-width":"250px"},attrs:{onfocus:"this.select();"},domProps:{value:"\x3c!-- tag::ad('"+t.row.abc+"') --\x3e"}})]}}])}),e("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(s){return[1==s.row.status?e("el-tag",{attrs:{type:"success",size:"small"}},[t._v("已开启")]):t._e(),0==s.row.status?e("el-tag",{attrs:{type:"info",size:"small"}},[t._v("已关闭")]):t._e()]}}])}),e("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"list-actions"},[e("span",[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.routerTo("/ads/edit?id="+s.row.id)}}},[t._v("修改")])],1),e("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:function(e){return t.ajaxGet("?m=ads&a=del&id="+s.row.id)}}},[e("el-link",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v("删除")])],1)],1)]}}])})],1)],1),e("div",{staticClass:"cp-pages skeleton"},[e("el-pagination",{attrs:{"current-page":t.page,"page-size":t.pagesize,"hide-on-single-page":!0,background:"",layout:"prev, pager, next",total:t.total},on:{"current-change":e=>{t.routerUpdate({page:e})}}})],1)])},rt=[],ot={mixins:[j],data(){return{pagesize:20,total:0,listData:[]}},methods:{pageInit(){return new Promise(t=>{this.$axios.post("?m=ads",{pagesize:this.pagesize,page:this.page}).then(e=>{this.listData=e.data.success.list,this.total=parseInt(e.data.success.total),t()})})}}},nt=ot,ct=Object(u["a"])(nt,lt,rt,!1,null,null,null),ut=ct.exports,dt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/ads"}},[t._v("广告管理")]),e("el-breadcrumb-item",[t._v("广告详情")])],1)],1),e("div",{staticClass:"cp-form"},[e("div",{staticClass:"box"},[e("el-form",{ref:"form",attrs:{model:t.form,size:"mini","label-width":"120px"}},[e("el-form-item",{staticClass:"skeleton",attrs:{label:"广告位标记"}},[e("el-input",{staticStyle:{width:"300px"},attrs:{disabled:t.form.id>0,placeholder:"任意字母和数字，不能和其他广告位重复"},model:{value:t.form.abc,callback:function(e){t.$set(t.form,"abc",e)},expression:"form.abc"}})],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"广告位名称"}},[e("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"任意方便您记忆的名称"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"开启广告"}},[e("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}})],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"爬虫识别"}},[e("el-radio-group",{attrs:{size:"small"},model:{value:t.form.allowSpider,callback:function(e){t.$set(t.form,"allowSpider",e)},expression:"form.allowSpider"}},[e("el-radio",{attrs:{label:"1",border:""}},[t._v("不区分爬虫")]),e("el-radio",{attrs:{label:"0",border:""}},[t._v("爬虫不显示广告")])],1)],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"默认广告内容"}},[e("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",placeholder:"没有指定特定广告的站点显示该广告内容",autosize:{minRows:3,maxRows:10}},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"指定站点广告"}},[e("el-button",{staticClass:"el-icon-circle-plus",attrs:{type:"primary"},on:{click:function(e){return t.siteAdAdd()}}},[t._v("添加")]),e("div",{staticClass:"siteAdBox"},[t.subAds.length?e("div",t._l(t.subAds,(function(s,a){return e("div",{key:a,staticClass:"row"},[e("span",[t._v(t._s(s.name))]),e("div",[e("el-link",{staticClass:"el-icon-edit",on:{click:function(e){return t.subAdEdit(s)}}},[t._v("修改")]),e("el-link",{staticClass:"el-icon-delete",on:{click:function(e){return t.subAdDel(s.id)}}},[t._v("删除")])],1)])})),0):t._e(),t.subAds.length?t._e():e("div",[t._v("暂无")])])],1),e("el-form-item",[e("el-button",{staticClass:"skeleton",attrs:{type:"primary",size:"medium"},on:{click:function(e){return t.submitForm()}}},[t._v("保存")])],1)],1)],1)]),e("el-dialog",{attrs:{title:"指定站点广告设置",visible:t.siteAdAddVisible},on:{"update:visible":function(e){t.siteAdAddVisible=e}}},[e("el-form",{attrs:{model:t.adAddForm}},[e("el-form-item",{attrs:{label:"广告站点","label-width":"120"}},[e("el-select",{staticStyle:{width:"300px"},attrs:{multiple:"",filterable:"","reserve-keyword":"",placeholder:"选择站点"},model:{value:t.siteSelectIds,callback:function(e){t.siteSelectIds=e},expression:"siteSelectIds"}},t._l(t.sitesList,(function(t,s){return e("el-option",{key:s,attrs:{label:t.sitename+"("+t.name+")",value:t.id}})})),1)],1),e("el-form-item",{attrs:{label:"广告内容","label-width":"120"}},[e("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",placeholder:"指定站点显示的广告内容",autosize:{minRows:3,maxRows:10}},model:{value:t.adAddForm.content,callback:function(e){t.$set(t.adAddForm,"content",e)},expression:"adAddForm.content"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.siteAdAddVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.siteAdAddSubmit}},[t._v("确 定")])],1)],1)],1)},mt=[],pt={mixins:[j],data(){return{form:{},adAddForm:{},siteAdAddVisible:!1,siteSelectIds:[],subAds:[]}},methods:{pageInit(){if(this.$route.query.id)return new Promise(t=>{this.$axios.get("?m=ads&a=edit&id="+this.$route.query.id).then(e=>{this.form=e.data.success,this.subAdsLoad(),t()})})},subAdsLoad(){this.$axios.get("?m=ads&a=subedit&abc="+this.form.abc).then(t=>{this.subAds=t.data.success})},submitForm(){this.$axios.post("?m=ads&a=edit",this.form)},siteAdAdd(){this.form.id?(this.siteAdAddVisible=!0,this.siteSelectIds=[],this.adAddForm={}):this.$message({message:"请先保存广告位再设置指定站点",type:"error"})},subAdEdit(t){this.siteAdAddVisible=!0,this.siteSelectIds=[t.yuming_id],this.adAddForm={},this.$set(this.adAddForm,"content",t.content)},subAdDel(t){this.$axios.get("?m=ads&a=subdel&id="+t).then(t=>{t.data.success&&this.subAdsLoad()})},siteAdAddSubmit(){this.adAddForm.yuming_ids=this.siteSelectIds,this.adAddForm.abc=this.form.abc,this.adAddForm.status=this.form.status,this.$axios.post("?m=ads&a=subedit",this.adAddForm).then(t=>{t.data.success&&(this.siteAdAddVisible=!1,this.subAdsLoad())})}}},ht=pt,ft=(s("a028"),Object(u["a"])(ht,dt,mt,!1,null,"57de04b2",null)),bt=ft.exports,gt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[t.common.sites&&t.common.sites[t.siteId]?e("el-breadcrumb-item",{attrs:{to:"/home"}},[e("span",{staticClass:"siteTag el-icon-s-home"},[t._v(" "+t._s(t.common.sites[t.siteId].sitename)+" ")])]):t._e(),e("el-breadcrumb-item",[t._v("文章管理")])],1)],1),e("div",{staticClass:"cp-table-top cl"},[e("div",{staticClass:"fl"},[e("el-dropdown",{attrs:{"split-button":"",size:"medium",type:"primary",plain:""},on:{click:function(e){return t.articleAdd("single")},command:t.articleAdd}},[t._v(" 发布文章 "),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"single"}},[t._v("单站点发布")]),e("el-dropdown-item",{attrs:{command:"multi"}},[t._v("多站点发布")])],1)],1),t.showDelete?e("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:t.deleteArticles}},[t._v("删除选中")]):t._e()],1),e("div",{staticClass:"fr skeleton"},[e("form",{attrs:{method:"POST",onsubmit:"return false;"},on:{submit:function(e){return t.routerUpdate({page:null,kw:t.kw})}}},[e("el-input",{attrs:{clearable:"",name:"kw",size:"mini",placeholder:"搜索关键词"},on:{clear:function(e){return t.routerUpdate({page:null,kw:null})}},model:{value:t.kw,callback:function(e){t.kw=e},expression:"kw"}},[e("el-button",{attrs:{slot:"append","native-type":"submit",icon:"el-icon-search"},slot:"append"})],1)],1)])]),e("div",{staticClass:"cp-table skeleton"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.listData},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"45"}}),e("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}),e("el-table-column",{attrs:{"min-width":"300",label:"标题","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(s){return[e("a",{attrs:{href:s.row.url,target:"_blank"}},[""!=s.row.thumb?e("font",{staticClass:"el-icon-picture",attrs:{color:"#409EFF"}}):t._e(),e("span",[t._v(t._s(s.row.title))]),"h"==s.row.flag?e("font",{attrs:{color:"red",size:"-2"}},[t._v("[头条]")]):t._e(),"c"==s.row.flag?e("font",{attrs:{color:"red",size:"-2"}},[t._v("[推荐]")]):t._e(),"f"==s.row.flag?e("font",{attrs:{color:"red",size:"-2"}},[t._v("[幻灯片]")]):t._e(),"a"==s.row.flag?e("font",{attrs:{color:"red",size:"-2"}},[t._v("[特荐]")]):t._e(),"s"==s.row.flag?e("font",{attrs:{color:"red",size:"-2"}},[t._v("[滚动]")]):t._e(),"b"==s.row.flag?e("font",{attrs:{color:"red",size:"-2"}},[t._v("[加粗]")]):t._e()],1)]}}])}),e("el-table-column",{attrs:{prop:"classname",label:"栏目"}}),e("el-table-column",{attrs:{prop:"addtime",formatter:(e,s,a)=>t.formatTime(a),label:"时间",width:"150"}}),e("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(s){return[0==s.row.status?e("el-tag",{attrs:{type:"info",size:"small"}},[t._v("待审核")]):t._e(),1==s.row.status?e("el-tag",{attrs:{type:"success",size:"small"}},[t._v("已发表")]):t._e(),2==s.row.status?e("el-tag",{attrs:{type:"primary",size:"small"}},[t._v("定时发布")]):t._e()]}}])}),this.common.conf&&""!=this.common.conf.baidu_tui_token?e("el-table-column",{attrs:{label:"推送",formatter:t.pingStatus,prop:"ping_status"}}):t._e(),e("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"list-actions"},[e("span",[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.edit(s.row.id)}}},[t._v("修改")])],1),e("el-popconfirm",{attrs:{title:"确定要删除吗？"},on:{confirm:function(e){return t.del(s.row.id)}}},[e("el-link",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v("删除")])],1)],1)]}}])})],1)],1),e("div",{staticClass:"cp-pages skeleton"},[e("el-pagination",{attrs:{"current-page":t.page,"page-size":t.pagesize,"hide-on-single-page":!0,background:"",layout:"prev, pager, next",total:t.total},on:{"current-change":e=>{t.routerUpdate({page:e})}}})],1)])},vt=[],wt={mixins:[j],data(){return{kw:"",pagesize:20,total:0,listData:[],showDelete:!1,selectIds:[]}},methods:{pageInit(){return new Promise(t=>{this.kw=this.$route.query.kw,this.$axios.post("?m=article",{pagesize:this.pagesize,page:this.page,kw:this.kw}).then(e=>{e.data.success&&(this.listData=e.data.success.list,this.total=parseInt(e.data.success.total),t())})})},handleSelectionChange(t){for(var e in this.selectIds=[],t)this.selectIds.push(t[e].id);this.showDelete=this.selectIds.length>0},deleteArticles(){this.$axios.post("?m=article&a=del",{id:this.selectIds}).then(t=>{t.data.success&&this.pageInit()})},articleAdd(t){this.routerTo("/article/edit?type="+t)},edit(t){this.routerTo("/article/edit?id="+t)},del(t){this.selectIds=[t],this.deleteArticles()},pingStatus:function(t,e,s){var a={0:"待推送",1:"已推送"},i={100:"未授权",101:"百度接口异常",102:"token错误",103:"not_same_site",104:"not_valid"};return a[s]?a[s]:i[t.ping_errMsg]?i[t.ping_errMsg]:"Status:"+s+" errMsg:"+t.ping_errMsg}}},yt=wt,_t=Object(u["a"])(yt,gt,vt,!1,null,null,null),kt=_t.exports,xt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/article"}},[t._v("文章管理")]),e("el-breadcrumb-item",[t._v(t._s("edit"==t.action?"修改文章":"添加文章"))])],1)],1),e("div",{staticClass:"cp-form postbox cl"},[e("div",{staticClass:"box ml"},[e("el-form",{ref:"formMain",attrs:{model:t.form,rules:t.rules,size:"mini","label-width":"80px"}},["multi"==t.type?e("el-form-item",{attrs:{label:"批量发布"}},[e("el-transfer",{attrs:{titles:["站点列表","已选择"],filterable:"","filter-method":t.filterMethod,"filter-placeholder":"站点搜索",data:t.sitesTransfer},model:{value:t.selectSiteids,callback:function(e){t.selectSiteids=e},expression:"selectSiteids"}})],1):t._e(),e("el-form-item",{attrs:{label:"文章标题",prop:"title"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{size:"medium",maxlength:"50","show-word-limit":""},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),e("el-form-item",{attrs:{label:"缩略图"}},[t.form.thumb?e("ul",{staticClass:"el-upload-list el-upload-list--picture-card"},[e("li",{staticClass:"el-upload-list__item",staticStyle:{height:"auto"}},[e("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:t.$baseHost+t.form.thumb}}),e("span",{staticClass:"el-upload-list__item-actions"},[e("span",{staticClass:"el-upload-list__item-preview",on:{click:function(e){t.thumbPreview=!0}}},[e("i",{staticClass:"el-icon-zoom-in"})]),e("span",{staticClass:"el-upload-list__item-delete",on:{click:t.removeThumb}},[e("i",{staticClass:"el-icon-delete"})])])])]):e("el-upload",{attrs:{"list-type":"picture-card",action:"/null","http-request":t.uploadFile,"show-file-list":!1}},[e("i",{staticClass:"el-icon-plus"})]),e("el-dialog",{attrs:{visible:t.thumbPreview},on:{"update:visible":function(e){t.thumbPreview=e}}},[e("img",{attrs:{width:"100%",src:t.$baseHost+t.form.thumb,alt:""}})])],1),e("el-form-item",{attrs:{label:"文章正文",prop:"body"}},[e("editor",{attrs:{value:t.form.body},on:{input:t.editorInput}})],1),e("el-form-item",{attrs:{label:"关键词"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{size:"medium"},model:{value:t.form.keyword,callback:function(e){t.$set(t.form,"keyword",e)},expression:"form.keyword"}})],1),e("el-form-item",{attrs:{label:"文章摘要"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{size:"medium",type:"textarea",autosize:{minRows:4}},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),"add"==t.action?e("el-form-item",[e("el-alert",{attrs:{title:"编辑内容自动保存，关闭后下次进入此页面可重新加载",type:"info"}})],1):t._e()],1)],1),e("div",{staticClass:"box mr"},[e("el-form",{ref:"formSide",attrs:{"label-position":"top",model:t.form,"label-width":"40px"}},[e("div",{staticStyle:{"padding-bottom":"20px","padding-top":"10px"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm(1)}}},[t._v(t._s("add"==t.action?"发布文章":"更新文章"))]),"add"==t.action?e("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){return t.savedraft(1)}}},[t._v("保存草稿")]):t._e(),"edit"==t.action?e("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){return t.submitForm(0)}}},[t._v("设为待审")]):t._e()],1),e("el-form-item",{attrs:{label:"栏目"}},[e("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:t.form.class,callback:function(e){t.$set(t.form,"class",e)},expression:"form.class"}},t._l(t.classlist,(function(t){return e("el-option",{key:t.ename,attrs:{label:t.title,value:t.ename}})})),1)],1),e("el-form-item",{attrs:{label:"属性"}},[e("el-checkbox-group",{attrs:{min:0,max:1},model:{value:t.flag,callback:function(e){t.flag=e},expression:"flag"}},[e("el-checkbox",{attrs:{label:"h"}},[t._v("头条[h]")]),e("el-checkbox",{attrs:{label:"c"}},[t._v("推荐[c]")]),e("el-checkbox",{attrs:{label:"f"}},[t._v("幻灯[f]")]),e("el-checkbox",{attrs:{label:"a"}},[t._v("特荐[a]")]),e("el-checkbox",{attrs:{label:"s"}},[t._v("滚动[s]")]),e("el-checkbox",{attrs:{label:"b"}},[t._v("加粗[b]")])],1)],1),e("el-form-item",{attrs:{label:"标签"}},[e("el-select",{attrs:{multiple:"",filterable:"",remote:"","allow-create":"","default-first-option":"",placeholder:"请选择文章标签","remote-method":t.remoteTags},model:{value:t.form.tags,callback:function(e){t.$set(t.form,"tags",e)},expression:"form.tags"}},t._l(t.tags,(function(t){return e("el-option",{key:t.tagsname,attrs:{label:t.tagsname,value:t.tagsname}})})),1),e("el-button",{attrs:{type:"info",plain:""},on:{click:t.tagManage}},[t._v("管理")])],1),e("el-form-item",{attrs:{label:"定时发布"}},[e("el-date-picker",{attrs:{editable:!1,clearable:!1,"value-format":"timestamp",type:"datetime",placeholder:"选择发布时间"},model:{value:t.timestamp,callback:function(e){t.timestamp=e},expression:"timestamp"}})],1)],1)],1)]),e("el-dialog",{attrs:{title:"文章发布结果",width:"700px","close-on-click-modal":!1,"close-on-press-escape":!1,"lock-scroll":"",visible:t.dialogTableVisible},on:{"update:visible":function(e){t.dialogTableVisible=e},closed:function(e){return t.$router.go(-1)}}},[e("el-table",{attrs:{data:t.publishResult,"row-class-name":t.rowColor}},[e("el-table-column",{attrs:{property:"sitename",label:"站点",width:"150"}}),e("el-table-column",{attrs:{property:"status",formatter:t.formatStatus,label:"状态",width:"100"}}),e("el-table-column",{attrs:{property:"url",label:"文章网址"}})],1)],1)],1)},Ct=[],St=function(){var t=this;t._self._c;return t._m(0)},$t=[function(){var t=this,e=t._self._c;return e("div",[e("textarea",{attrs:{id:"editor"}})])}],Tt={name:"editor",props:{value:{type:String,default:""}},data(){return{loadTimer:null,hasChange:!1,hasInit:!1,fullscreen:!1,toolbar:["searchreplace bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap preview anchor insertdatetime media table emoticons forecolor backcolor fullscreen"],plugins:["advlist anchor autolink code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"]}},computed:{},watch:{value(t){!this.hasChange&&this.hasInit&&this.$nextTick(()=>window.tinymce.get("editor").setContent(t||""))}},mounted(){this.loadTimer=setInterval(()=>{console.log(window.tinymce),window.tinymce&&(this.initTinymce(),clearInterval(this.loadTimer))},100)},activated(){window.tinymce&&this.initTinymce()},deactivated(){this.destroyTinymce()},destroyed(){this.destroyTinymce()},methods:{initTinymce(){window.tinymce.addI18n("zh_CN",{Redo:"重做",Undo:"撤销",Cut:"剪切",Copy:"复制",Paste:"粘贴","Select all":"全选","New document":"新文件",Ok:"确定",Cancel:"取消","Visual aids":"网格线",Bold:"粗体",Italic:"斜体",Underline:"下划线",Strikethrough:"删除线",Superscript:"上标",Subscript:"下标","Clear formatting":"清除格式",Remove:"移除","Align left":"左边对齐","Align center":"中间对齐","Align right":"右边对齐","No alignment":"未对齐",Justify:"两端对齐","Bullet list":"无序列表","Numbered list":"编号列表","Decrease indent":"减少缩进","Increase indent":"增加缩进",Close:"关闭",Formats:"格式","Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.":"你的浏览器不支持打开剪贴板，请使用Ctrl+X/C/V等快捷键。",Headings:"标题","Heading 1":"标题1","Heading 2":"标题2","Heading 3":"标题3","Heading 4":"标题4","Heading 5":"标题5","Heading 6":"标题6",Preformatted:"预先格式化的",Div:"分区",Pre:"前言",Code:"代码",Paragraph:"段落",Blockquote:"引文区块",Inline:"文本",Blocks:"基块","Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off.":"当前为纯文本粘贴模式，再次点击可以回到普通粘贴模式。",Fonts:"字体","Font sizes":"字体大小",Class:"类型","Browse for an image":"浏览图像",OR:"或","Drop an image here":"拖放一张图像至此",Upload:"上传","Uploading image":"上传图片",Block:"块",Align:"对齐",Default:"预设",Circle:"空心圆",Disc:"实心圆",Square:"实心方块","Lower Alpha":"小写英文字母","Lower Greek":"小写希腊字母","Lower Roman":"小写罗马数字","Upper Alpha":"大写英文字母","Upper Roman":"大写罗马数字","Anchor...":"锚点...",Anchor:"锚点",Name:"名称",ID:"ID","ID should start with a letter, followed only by letters, numbers, dashes, dots, colons or underscores.":"ID应该以英文字母开头，后面只能有英文字母、数字、破折号、点、冒号或下划线。","You have unsaved changes are you sure you want to navigate away?":"你还有文档尚未保存，确定要离开？","Restore last draft":"恢复上次的草稿","Special character...":"特殊字符...","Special Character":"特殊字符","Source code":"源代码","Insert/Edit code sample":"插入/编辑代码示例",Language:"语言","Code sample...":"示例代码...","Left to right":"由左到右","Right to left":"由右到左",Title:"标题",Fullscreen:"全屏幕",Action:"动作",Shortcut:"快捷方式",Help:"帮助",Address:"地址","Focus to menubar":"移动焦点到菜单栏","Focus to toolbar":"移动焦点到工具栏","Focus to element path":"移动焦点到元素路径","Focus to contextual toolbar":"移动焦点到上下文菜单","Insert link (if link plugin activated)":"插入链接 (如果链接插件已激活)","Save (if save plugin activated)":"保存(如果保存插件已激活)","Find (if searchreplace plugin activated)":"查找(如果查找替换插件已激活)","Plugins installed ({0}):":"已安装插件 ({0}):","Premium plugins:":"优秀插件：","Learn more...":"了解更多...","You are using {0}":"你正在使用 {0}",Plugins:"全部外挂程序","Handy Shortcuts":"快捷键","Horizontal line":"水平分割线","Insert/edit image":"插入/编辑图片","Alternative description":"替代描述",Accessibility:"辅助功能","Image is decorative":"图像是装饰性的",Source:"原始码",Dimensions:"尺寸","Constrain proportions":"保持比例",General:"一般",Advanced:"高级",Style:"样式","Vertical space":"垂直间距","Horizontal space":"水平间距",Border:"框线","Insert image":"插入图片","Image...":"图片...","Image list":"图片清单",Resize:"调整大小","Insert date/time":"插入日期/时间","Date/time":"日期/时间","Insert/edit link":"插入/编辑链接","Text to display":"要显示的文本",Url:"地址","Open link in...":"链接打开位置...","Current window":"当前窗口",None:"无","New window":"新窗口","Open link":"打开链接","Remove link":"移除链接",Anchors:"锚点","Link...":"链接...","Paste or type a link":"粘贴或输入链接","The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?":"你所填写的URL地址为邮件地址，需要加上mailto:前缀吗？","The URL you entered seems to be an external link. Do you want to add the required http:// prefix?":"你所填写的URL地址属于外部链接，需要加上http://:前缀吗？","The URL you entered seems to be an external link. Do you want to add the required https:// prefix?":"您输入的 URL 似乎是一个外部链接。您想添加所需的 https:// 前缀吗？","Link list":"链接清单","Insert video":"插入视频","Insert/edit video":"插入/编辑视频","Insert/edit media":"插入/编辑媒体","Alternative source":"镜像","Alternative source URL":"替代来源网址","Media poster (Image URL)":"封面(图片地址)","Paste your embed code below:":"将内嵌代码粘贴在下面:",Embed:"内嵌","Media...":"多媒体...","Nonbreaking space":"不间断空格","Page break":"分页符","Paste as text":"粘贴为文本",Preview:"预览",Print:"打印","Print...":"打印...",Save:"保存",Find:"寻找","Replace with":"替换为",Replace:"替换","Replace all":"替换全部",Previous:"上一个",Next:"下一个","Find and Replace":"查找和替换","Find and replace...":"查找并替换...","Could not find the specified string.":"未找到搜索内容。","Match case":"大小写匹配","Find whole words only":"全字匹配","Find in selection":"在选区中查找","Insert table":"插入表格","Table properties":"表格属性","Delete table":"删除表格",Cell:"储存格",Row:"行",Column:"栏目","Cell properties":"单元格属性","Merge cells":"合并单元格","Split cell":"拆分单元格","Insert row before":"在上方插入行","Insert row after":"在下方插入行","Delete row":"删除行","Row properties":"行属性","Cut row":"剪切行","Cut column":"剪切列","Copy row":"复制行","Copy column":"复制列","Paste row before":"粘贴行到上方","Paste column before":"粘贴此列前","Paste row after":"粘贴行到下方","Paste column after":"粘贴后面的列","Insert column before":"在左侧插入列","Insert column after":"在右侧插入列","Delete column":"删除列",Cols:"列",Rows:"行数",Width:"宽度",Height:"高度","Cell spacing":"单元格外间距","Cell padding":"单元格内边距","Row clipboard actions":"行剪贴板操作","Column clipboard actions":"列剪贴板操作","Table styles":"表格样式","Cell styles":"单元格样式","Column header":"列标题","Row header":"行头","Table caption":"表格标题",Caption:"标题","Show caption":"显示标题",Left:"左",Center:"居中",Right:"右","Cell type":"储存格别",Scope:"范围",Alignment:"对齐","Horizontal align":"水平对齐","Vertical align":"垂直对齐",Top:"上方对齐",Middle:"居中对齐",Bottom:"下方对齐","Header cell":"表头单元格","Row group":"行组","Column group":"列组","Row type":"行类型",Header:"表头",Body:"表体",Footer:"表尾","Border color":"框线颜色",Solid:"实线",Dotted:"虚线",Dashed:"虚线",Double:"双精度",Groove:"凹槽",Ridge:"海脊座",Inset:"嵌入",Outset:"外置",Hidden:"隐藏","Insert template...":"插入模板...",Templates:"模板",Template:"模板","Insert Template":"插入模板","Text color":"文本颜色","Background color":"背景颜色","Custom...":"自定义......","Custom color":"自定义颜色","No color":"无","Remove color":"移除颜色","Show blocks":"显示区块边框","Show invisible characters":"显示不可见字符","Word count":"字数",Count:"计数",Document:"文档",Selection:"选择",Words:"单词","Words: {0}":"字数：{0}","{0} words":"{0} 字",File:"文件",Edit:"编辑",Insert:"插入",View:"查看",Format:"格式",Table:"表格",Tools:"工具","Powered by {0}":"由{0}驱动","Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help":"编辑区。按ALT-F9打开菜单，按ALT-F10打开工具栏，按ALT-0查看帮助","Image title":"图片标题","Border width":"边框宽度","Border style":"边框样式",Error:"错误",Warn:"警告",Valid:"有效","To open the popup, press Shift+Enter":"按Shitf+Enter键打开对话框","Rich Text Area":"富文本区域","Rich Text Area. Press ALT-0 for help.":"编辑区。按Alt+0键打开帮助。","System Font":"系统字体","Failed to upload image: {0}":"图片上传失败: {0}","Failed to load plugin: {0} from url {1}":"插件加载失败: {0} 来自链接 {1}","Failed to load plugin url: {0}":"插件加载失败 链接: {0}","Failed to initialize plugin: {0}":"插件初始化失败: {0}",example:"示例",Search:"搜索",All:"全部",Currency:"货币",Text:"文字",Quotations:"引用",Mathematical:"数学","Extended Latin":"拉丁语扩充",Symbols:"符号",Arrows:"箭头","User Defined":"自定义","dollar sign":"美元符号","currency sign":"货币符号","euro-currency sign":"欧元符号","colon sign":"冒号","cruzeiro sign":"克鲁赛罗币符号","french franc sign":"法郎符号","lira sign":"里拉符号","mill sign":"密尔符号","naira sign":"奈拉符号","peseta sign":"比塞塔符号","rupee sign":"卢比符号","won sign":"韩元符号","new sheqel sign":"新谢克尔符号","dong sign":"越南盾符号","kip sign":"老挝基普符号","tugrik sign":"图格里克符号","drachma sign":"德拉克马符号","german penny symbol":"德国便士符号","peso sign":"比索符号","guarani sign":"瓜拉尼符号","austral sign":"澳元符号","hryvnia sign":"格里夫尼亚符号","cedi sign":"塞地符号","livre tournois sign":"里弗弗尔符号","spesmilo sign":"spesmilo符号","tenge sign":"坚戈符号","indian rupee sign":"印度卢比","turkish lira sign":"土耳其里拉","nordic mark sign":"北欧马克","manat sign":"马纳特符号","ruble sign":"卢布符号","yen character":"日元字样","yuan character":"人民币元字样","yuan character, in hong kong and taiwan":"元字样（港台地区）","yen/yuan character variant one":"元字样（大写）",Emojis:"Emojis","Emojis...":"Emojis...","Loading emojis...":"正在加载Emojis...","Could not load emojis":"无法加载Emojis",People:"人类","Animals and Nature":"动物和自然","Food and Drink":"食物和饮品",Activity:"活动","Travel and Places":"旅游和地点",Objects:"物件",Flags:"旗帜",Characters:"字符","Characters (no spaces)":"字符(无空格)","{0} characters":"{0} 个字符","Error: Form submit field collision.":"错误: 表单提交字段冲突。","Error: No form element found.":"错误: 没有表单控件。","Color swatch":"颜色样本","Color Picker":"选色器","Invalid hex color code: {0}":"十六进制颜色代码无效： {0}","Invalid input":"无效输入",R:"R","Red component":"红色部分",G:"G","Green component":"绿色部分",B:"B","Blue component":"白色部分","#":"#","Hex color code":"十六进制颜色代码","Range 0 to 255":"范围0至255",Turquoise:"青绿色",Green:"绿色",Blue:"蓝色",Purple:"紫色","Navy Blue":"海军蓝","Dark Turquoise":"深蓝绿色","Dark Green":"深绿色","Medium Blue":"中蓝色","Medium Purple":"中紫色","Midnight Blue":"深蓝色",Yellow:"黄色",Orange:"橙色",Red:"红色","Light Gray":"浅灰色",Gray:"灰色","Dark Yellow":"暗黄色","Dark Orange":"深橙色","Dark Red":"深红色","Medium Gray":"中灰色","Dark Gray":"深灰色","Light Green":"浅绿色","Light Yellow":"浅黄色","Light Red":"浅红色","Light Purple":"浅紫色","Light Blue":"浅蓝色","Dark Purple":"深紫色","Dark Blue":"深蓝色",Black:"黑色",White:"白色","Switch to or from fullscreen mode":"切换全屏模式","Open help dialog":"打开帮助对话框",history:"历史",styles:"样式",formatting:"格式化",alignment:"对齐",indentation:"缩进",Font:"字体",Size:"字号","More...":"更多...","Select...":"选择...",Preferences:"首选项",Yes:"是",No:"否","Keyboard Navigation":"键盘指引",Version:"版本","Code view":"代码视图","Open popup menu for split buttons":"打开弹出式菜单，用于拆分按钮","List Properties":"列表属性","List properties...":"标题字体属性","Start list at number":"以数字开始列表","Line height":"行高","Dropped file type is not supported":"此文件类型不支持拖放","Loading...":"加载中...","ImageProxy HTTP error: Rejected request":"","ImageProxy HTTP error: Could not find Image Proxy":"","ImageProxy HTTP error: Incorrect Image Proxy URL":"","ImageProxy HTTP error: Unknown ImageProxy error":""}),window.tinymce.init({selector:"#editor",language:"zh_CN",menubar:!1,statusbar:!1,height:350,body_class:"contentbody",toolbar:this.toolbar,plugins:this.plugins,end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:[],default_link_target:"_blank",link_title:!1,nonbreaking_force_tab:!0,automatic_uploads:!0,file_picker_types:"file image media",images_upload_handler:(t,e)=>{var s=t.blob();let a=new FormData;a.append("file",s),this.$axios.post("?m=upload",a,{headers:{"Content-Type":"multipart/form-data;charset=UTF-8"}}).then(t=>{e(this.$baseHost+t.data.success.location)})},init_instance_callback:t=>{this.value&&t.setContent(this.value),this.hasInit=!0,t.on("NodeChange Change KeyUp SetContent",()=>{this.hasChange=!0;var e=t.getContent().replace(/\.\.\/uploads\//gi,"/uploads/");this.$emit("input",e)})}})},destroyTinymce(){const t=window.tinymce.get("editor");this.fullscreen&&t.execCommand("mceFullScreen"),t&&t.destroy()}}},At=Tt,It=Object(u["a"])(At,St,$t,!1,null,null,null),zt=It.exports,Dt={mixins:[j],components:{editor:zt},data(){return{form:{},sitesTransfer:[],selectSiteids:[],classlist:{},tags:[],rules:{title:[{required:!0,message:"请输入文章标题",trigger:"change"}]},thumbPreview:!1,publishResult:[],dialogTableVisible:!1}},computed:{action(){return this.$route.query.id?"edit":"add"},type(){return this.$route.query.type?this.$route.query.type:"single"},flag:{get:function(){return this.form.flag?[this.form.flag]:[]},set:function(t){this.$set(this.form,"flag",t.length>0?t[0]:"")}},timestamp:{get:function(){return 1e3*this.form.addtime},set:function(t){this.$set(this.form,"addtime",t/1e3)}}},watch:{form:{handler(){this.savedraft()},deep:!0}},methods:{pageInit(){this.selectSiteids.push(this.siteId),this.sitesTransfer=[];for(let t in this.sites)this.sitesTransfer.push({key:this.sites[t].id,label:this.sites[t].sitename});if(this.$axios.get("?m=article&a=classlist").then(t=>{this.classlist=t.data.success}),this.remoteTags(),"add"==this.action){let t=window.localStorage.getItem("draftData");t&&this.$confirm("是否加载草稿箱内容","提示",{confirmButtonText:"载入",cancelButtonText:"取消",type:"warning"}).then(()=>{this.form=JSON.parse(t)})}else if(this.$route.query.id)return new Promise(t=>{this.$axios.get("?m=article&a=edit&id="+this.$route.query.id).then(e=>{e.data.success&&(this.form=e.data.success,t())})})},uploadFile(t){let e=new FormData;e.append("file",t.file),this.$axios.post("?m=upload",e,{headers:{"Content-Type":"multipart/form-data;charset=UTF-8"}}).then(t=>{this.$set(this.form,"thumb",t.data.success.location)})},removeThumb(){this.$set(this.form,"thumb","")},filterMethod(t,e){var s=e.label+e.name;return s.indexOf(t)>-1},editorInput(t){this.$set(this.form,"body",t)},remoteTags(t){this.$axios.get("?m=article&a=tags",{params:{kw:t||""}}).then(t=>{this.tags=t.data})},formatStatus(t,e,s){var a={padding:"准备发布",running:"发布中",success:"成功",error:"错误"};return a[s]},rowColor({row:t}){var e={padding:"",running:"running-row",success:"success-row",error:"error-row"};return e[t.status]},submitForm(t){this.form.status=t,this.$refs["formMain"].validate(t=>{if(t){if(!this.form.body)return this.$message.error("请先填写文章内容"),!1;if(0==this.selectSiteids.length)return this.$message.error("请选择发布站点"),!1;this.publishResult=[];for(let t in this.selectSiteids)this.publishResult.push({id:this.selectSiteids[t],sitename:this.sites[this.selectSiteids[t]].sitename,status:"padding",url:""});this.selectSiteids.length>1&&(this.dialogTableVisible=!0),this.postArt(0)}})},postArt(t){this.publishResult.length>t?(this.publishResult[t].status="running",this.form.siteId=this.publishResult[t].id,this.$axios.post("?m=article&a=edit",this.form).then(e=>{e.data.success?(this.publishResult[t].status="success",this.publishResult[t].url=e.data.url):e.data.error&&(this.publishResult[t].status="error",this.publishResult[t].url=e.data.tip),this.postArt(++t)}).catch(()=>{this.publishResult[t].status="error",this.publishResult[t].url="网络错误",this.postArt(++t)})):(window.localStorage.removeItem("draftData"),1==this.selectSiteids.length&&"success"==this.publishResult[0].status&&(this.$message({message:"保存成功",type:"success"}),this.$router.go(-1)))},savedraft(t=0){"add"==this.action&&(this.form.title||this.form.body)&&(window.localStorage.setItem("draftData",JSON.stringify(this.form)),t&&this.$notify({title:"成功",duration:1e3,message:"草稿保存成功",type:"success"}))},tagManage(){this.$confirm("即将离开此页面，未保存内容将丢失","提示",{confirmButtonText:"离开",cancelButtonText:"取消",type:"warning"}).then(()=>{this.routerTo("/tags")})}}},Ft=Dt,Rt=Object(u["a"])(Ft,xt,Ct,!1,null,null,null),jt=Rt.exports,Pt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/classlist"}},[t._v("栏目管理")])],1)],1),e("div",{staticClass:"cp-table-top"},[e("el-button",{attrs:{size:"medium",type:"primary",plain:""},on:{click:function(e){return t.routerTo("/classlist/edit")}}},[t._v("新建栏目")])],1),e("div",{staticClass:"cp-table skeleton"},[t.reshow?e("el-table",{ref:"listTable",staticStyle:{width:"100%"},attrs:{data:t.listData}},[e("el-table-column",{attrs:{prop:"id",width:"36"},scopedSlots:t._u([{key:"default",fn:function(s){return[1==s.row.status?e("el-popover",{attrs:{placement:"right",trigger:"hover"}},[e("div",[e("el-link",{staticClass:"el-icon-top",attrs:{slot:"reference",type:"primary"},on:{click:function(e){return t.sort(s.row.id,"up")}},slot:"reference"},[t._v("上移")]),e("el-link",{staticClass:"el-icon-bottom",attrs:{slot:"reference",type:"primary"},on:{click:function(e){return t.sort(s.row.id,"down")}},slot:"reference"},[t._v("下移")])],1),e("el-link",{staticClass:"el-icon-d-caret",attrs:{slot:"reference",type:"primary"},slot:"reference"})],1):t._e()]}}],null,!1,2016737512)}),e("el-table-column",{attrs:{prop:"title",label:"栏目名称"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",[t._v(t._s(s.row.title))])]}}],null,!1,1808518502)}),e("el-table-column",{attrs:{prop:"ename",label:"栏目目录"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",[t._v(t._s(s.row.ename))]),e("i",{staticStyle:{color:"#ccc","font-size":"12px"}},[t._v("(id:"+t._s(s.row.id)+")")])]}}],null,!1,1780581264)}),e("el-table-column",{attrs:{prop:"status",label:"状态",filters:[{text:"启用的栏目",value:"open"},{text:"禁用的栏目",value:"close"}],"filter-multiple":!1,"filter-method":t.filterStatus,"filtered-value":t.filteredValue},scopedSlots:t._u([{key:"default",fn:function(s){return[1==s.row.status?e("el-tag",{attrs:{type:"success",size:"small"}},[t._v("启用")]):t._e(),0==s.row.status?e("el-tag",{attrs:{type:"info",size:"small"}},[t._v("禁用")]):t._e()]}}],null,!1,3482395958)}),e("el-table-column",{attrs:{label:"操作",width:"160"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"list-actions"},[e("span",[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.routerTo("/classlist/edit?id="+s.row.id)}}},[t._v("修改")])],1),e("el-popconfirm",{attrs:{title:"确定要删除吗?"},on:{confirm:function(e){return t.ajaxGet("?m=classlist&a=del&id="+s.row.id)}}},[e("el-link",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v("删除")])],1),0==s.row.status?e("span",[e("el-link",{attrs:{type:"success"},on:{click:function(e){return t.ajaxGet("?m=classlist&a=open&id="+s.row.id)}}},[t._v("启用")])],1):t._e(),1==s.row.status?e("el-popconfirm",{attrs:{title:"确定要禁用默认栏目吗?"},on:{confirm:function(e){return t.ajaxGet("?m=classlist&a=stop&id="+s.row.id)}}},[e("el-link",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v("禁用")])],1):t._e()],1)]}}],null,!1,2840842151)})],1):t._e(),"open"==t.filteredValue[0]&&t.disableClassNum>0?e("div",{staticClass:"box-column",staticStyle:{color:"#ccc","font-size":"12px","text-align":"center",cursor:"pointer","margin-bottom":"40px"}},[e("p",{on:{click:t.showAllClass}},[t._v("展开其它"+t._s(t.disableClassNum)+"个未开启栏目")])]):t._e()],1)])},Nt=[],Lt={mixins:[j],data(){return{listData:[],filteredValue:["open"],reshow:!0}},computed:{disableClassNum(){var t=0;for(let e in this.listData)0==this.listData[e].status&&t++;return t}},methods:{pageInit(){return new Promise(t=>{this.$axios.post("?m=classlist").then(e=>{this.listData=e.data.success,t()})})},showAllClass(){this.filteredValue=[""],this.reshow=!1,this.$nextTick(()=>{this.reshow=!0})},filterStatus(t,e){return"open"==t?1==e["status"]:"close"!=t||0==e["status"]},sort(t,e){var s=[];for(let i in this.listData)if(1==this.listData[i].status&&(s.push({id:this.listData[i].id,weight:s.length}),this.listData[i].id==t))var a=s.length-1;"up"==e&&a>0&&(s[parseInt(a)-1].weight++,s[a].weight--),"down"==e&&a<s.length-1&&(s[parseInt(a)+1].weight--,s[a].weight++),this.$axios.post("?m=classlist&a=weight",{data:s}).then(t=>{t.data.success&&this.pageInit()})}}},qt=Lt,Ot=Object(u["a"])(qt,Pt,Nt,!1,null,null,null),Bt=Ot.exports,Vt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/classlist"}},[t._v("栏目管理")]),e("el-breadcrumb-item",[t._v("编辑栏目")])],1)],1),e("div",{staticClass:"cp-form"},[e("div",{staticClass:"box"},[e("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-position":"top",size:"mini","label-width":"80px"}},[e("el-form-item",{staticClass:"skeleton",attrs:{label:"栏目名称",prop:"title"}},[e("el-input",{staticStyle:{width:"300px"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"栏目目录",prop:"ename"}},[e("el-input",{staticStyle:{width:"300px"},attrs:{placeHolder:"栏目目录由字母和数字构成，且必须字母开头"},model:{value:t.form.ename,callback:function(e){t.$set(t.form,"ename",e)},expression:"form.ename"}})],1),e("el-form-item",{staticClass:"skeleton"},[e("el-button",{attrs:{type:"primary",loading:t.axiosLoading,size:"medium"},on:{click:function(e){return t.submitForm(!0)}}},[t._v("保存")])],1)],1)],1)])])},Et=[],Ut={mixins:[j],data(){return{form:{},rules:{title:[{required:!0,message:"请输入栏目名称",trigger:"change"}],ename:[{required:!0,message:"栏目目录由字母和数字构成，且必须字母开头",trigger:"change"}]}}},methods:{pageInit(){if(this.$route.query.id)return new Promise(t=>{this.$axios.get("?m=classlist&a=edit&id="+this.$route.query.id).then(e=>{e.data.success&&(this.form=e.data.success,t())})})},submitForm(){this.$axios.post("?m=classlist&a=edit",this.form)}}},Ht=Ut,Mt=Object(u["a"])(Ht,Vt,Et,!1,null,null,null),Gt=Mt.exports,Wt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/crawler"}},[t._v("采集管理")])],1)],1),e("el-tabs",{attrs:{type:"border-card"},model:{value:t.tabName,callback:function(e){t.tabName=e},expression:"tabName"}},[e("el-tab-pane",{attrs:{label:"规则采集",name:"crawlRule",lazy:!0}},[e("div",{staticClass:"cp-table-top"},[e("el-button",{attrs:{size:"medium",type:"primary",plain:""},on:{click:function(e){return t.routerTo("/crawler/edit")}}},[t._v("添加规则 ")])],1),e("div",{staticClass:"cp-table"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.crawlRule}},[e("el-table-column",{attrs:{prop:"id",label:"ID"}}),e("el-table-column",{attrs:{prop:"listurl",label:"采集地址"}}),e("el-table-column",{attrs:{prop:"yuming_id",label:"站点"},scopedSlots:t._u([{key:"default",fn:function(s){return[s.row.yuming_id>1?e("el-tag",{attrs:{type:"success",size:"small"}},[t._v("单站规则")]):t._e(),0==s.row.yuming_id?e("el-tag",{attrs:{type:"info",size:"small"}},[t._v("全局规则")]):t._e()]}}])}),e("el-table-column",{attrs:{prop:"crawlRule",label:"自动采集"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},on:{change:function(e){return t.crawlRuleChange(s.row)}},model:{value:s.row.autoStart,callback:function(e){t.$set(s.row,"autoStart",e)},expression:"scope.row.autoStart"}})]}}])},[e("template",{slot:"header"},[e("el-dropdown",{attrs:{trigger:"click",placement:"bottom"},on:{command:t.crawlRuleMultiSet}},[e("span",{staticClass:"el-dropdown-link"},[t._v(" 自动采集"),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"1"}},[t._v("全部开启")]),e("el-dropdown-item",{attrs:{command:"0"}},[t._v("全部关闭")])],1)],1)],1)],2),e("el-table-column",{attrs:{label:"操作",width:"170"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"list-actions"},[e("span",[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.start_caiji(s.row.id)}}},[t._v("采集")])],1),e("span",[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.routerTo("/crawler/edit?id="+s.row.id)}}},[t._v("修改")])],1),e("el-popconfirm",{attrs:{title:"确定要删除吗?"},on:{confirm:function(e){return t.ajaxGet("?m=crawler&a=crawlRuleDel&id="+s.row.id)}}},[e("el-link",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v("删除")])],1)],1)]}}])})],1)],1)]),e("el-tab-pane",{attrs:{label:"关键词采集",name:"crawlKeyword",lazy:!0}},[e("div",{staticClass:"infinite-list"},t._l(t.crawlKeyword.sites,(function(s,a){return e("clawlerListItem",{key:a,attrs:{site:s},on:{change:t.loadCrawlKeywordData}})})),1)]),e("el-tab-pane",{attrs:{label:"AI生成文章",name:"AiNews",lazy:!0}},[e("el-alert",{attrs:{type:"warning",closable:!1}},[t._v(" 本功能仅用于新站填充数据测试模版，不适用于线上运行网站，请删除数据后在上线 ")]),e("el-form",{ref:"form",staticStyle:{"margin-top":"20px"},attrs:{size:"mini","label-width":"120px"}},[e("el-form-item",{attrs:{label:"标题词汇"}},[e("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",rows:8,placeholder:"每个词生成一篇文章"},model:{value:t.AiNewsArgs.words,callback:function(e){t.$set(t.AiNewsArgs,"words",e)},expression:"AiNewsArgs.words"}})],1),e("el-form-item",{attrs:{label:"标题优化"}},[e("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.AiNewsArgs.titleBetter,callback:function(e){t.$set(t.AiNewsArgs,"titleBetter",e)},expression:"AiNewsArgs.titleBetter"}})],1),e("el-form-item",{attrs:{label:"文章长度"}},[e("el-input-number",{staticStyle:{width:"80px"},attrs:{controls:!1},model:{value:t.AiNewsArgs.bodyLength,callback:function(e){t.$set(t.AiNewsArgs,"bodyLength",e)},expression:"AiNewsArgs.bodyLength"}})],1),e("el-form-item",{attrs:{label:"高级处理"}},[e("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.AiNewsArgs.bodyBetter,callback:function(e){t.$set(t.AiNewsArgs,"bodyBetter",e)},expression:"AiNewsArgs.bodyBetter"}})],1),e("el-form-item",{attrs:{label:"站点"}},[t.AiNews?e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.AiNews.sites,"tooltip-effect":"dark",height:"350"},on:{"selection-change":t.AiNewsClassSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"55"}}),e("el-table-column",{attrs:{label:"站点"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.sitename)+"("+t._s(e.row.name)+")")]}}],null,!1,2627157105)}),e("el-table-column",{attrs:{label:"发布栏目"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-select",{staticStyle:{"margin-left":"20px"},attrs:{multiple:"","collapse-tags":"",placeholder:"默认全部栏目"},model:{value:s.row.classSeled,callback:function(e){t.$set(s.row,"classSeled",e)},expression:"scope.row.classSeled"}},t._l(s.row.class,(function(t){return e("el-option",{key:t.ename,attrs:{label:t.title,value:t.ename}})})),1)]}}],null,!1,3184267979)})],1):t._e()],1),e("el-form-item",[e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(e){return t.AiNewsSubmitForm()}}},[t._v("开始生成并发布")])],1)],1)],1)],1),e("el-dialog",{attrs:{title:"采集预览",visible:t.caiji.dialogVisible},on:{"update:visible":function(e){return t.$set(t.caiji,"dialogVisible",e)},close:t.close_caiji}},[e("div",{staticStyle:{position:"absolute",right:"80px",top:"22px"}},[e("el-link",{staticClass:"el-icon-delete",attrs:{type:"danger"},on:{click:function(e){return t.clearRuleLog(t.caiji.ruleid)}}},[t._v("清理采集缓存")])],1),t._l(t.caiji.result,(function(s,a){return e("div",{key:a,domProps:{innerHTML:t._s(s)}})}))],2),e("el-dialog",{attrs:{title:"生成预览",visible:t.AiCaiji.dialogVisible},on:{"update:visible":function(e){return t.$set(t.AiCaiji,"dialogVisible",e)},close:t.close_AiCaiji}},t._l(t.AiCaiji.result,(function(s,a){return e("div",{key:a,domProps:{innerHTML:t._s(s)}})})),0)],1)},Kt=[],Yt=function(){var t=this,e=t._self._c;return e("div",[e("el-popover",{attrs:{placement:"right",width:"600",trigger:"click",title:"设置栏目采集关键词"}},[e("div",{staticClass:"infinite-list-item",attrs:{slot:"reference"},slot:"reference"},[e("div",{staticClass:"infinite-list-name"},[t._v(t._s(t.site.sitename)+"("+t._s(t.site.name)+")")]),t.site.kwnum?e("span",{staticClass:"infinite-list-num"},[t._v(t._s(t.site.kwnum))]):t._e(),e("i",{staticClass:"el-icon-arrow-right"})]),e("div",{staticStyle:{display:"flex","flex-direction":"row"}},[e("div",{staticStyle:{display:"flex","flex-direction":"column","max-height":"500px",overflow:"scroll","padding-top":"10px"}},t._l(t.site.class,(function(s,a){return e("el-badge",{key:a,staticClass:"item",staticStyle:{"margin-right":"30px",width:"200px","margin-bottom":"15px"},attrs:{hidden:!t.getCrawlWordsNum(s.crawlWords),value:t.getCrawlWordsNum(s.crawlWords),type:"primary"}},[e("el-button",{staticStyle:{width:"200px"},attrs:{type:"primary",plain:s.id!=t.curClass.id},on:{click:function(e){return t.showDialog(s)}}},[t._v(t._s(s.title)),e("i",{staticClass:"el-icon-upload el-icon--right"})])],1)})),1),t.curClass.id?e("div",{staticStyle:{flex:"1"}},[e("el-input",{attrs:{type:"textarea",rows:20,width:"100%;",placeHolder:"填写要采集的关键词，每行一个"},model:{value:t.curClass.crawlWords,callback:function(e){t.$set(t.curClass,"crawlWords",e)},expression:"curClass.crawlWords"}}),e("div",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"flex-end",padding:"10px"}},[e("el-button",{on:{click:t.cancel}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保 存")])],1)],1):t._e()])])],1)},Jt=[],Qt={props:["site"],data(){return{curClass:[]}},methods:{getCrawlWordsNum(t){return""==t?0:t.split("\n").length},showDialog(t){this.curClass=t,this.dialogFormVisible=!0},cancel(){this.curClass=[],this.$emit("change",!0)},save(){this.$axios.post("?m=crawler&a=crawlKeywordSave",this.curClass).then(t=>{t.data.success&&(this.curClass=[],this.$emit("change",!0))})}}},Xt=Qt,Zt=(s("530c"),Object(u["a"])(Xt,Yt,Jt,!1,null,"29df32c9",null)),te=Zt.exports,ee={mixins:[j],components:{clawlerListItem:te},data(){return{visible:!1,crawlRule:[],crawlKeyword:[],AiNews:{},AiNewsArgs:{titleBetter:"1",bodyLength:500},caiji:{ruleid:"",dialogVisible:!1,source:null,result:[]},AiCaiji:{dialogVisible:!1,result:[]}}},computed:{tabName:{get:function(){return this.$route.query.tab?this.$route.query.tab:"crawlRule"},set:function(t){this.routerUpdate({tab:t})}}},methods:{pageInit(){var t=this.$route.query.tab;"crawlKeyword"==t?this.loadCrawlKeywordData():"crawlRule"==t?this.loadCrawlRuleData():"AiNews"==t&&this.loadAiNewsData()},loadCrawlKeywordData(){this.$axios.get("?m=crawler&a=crawlKeywordData").then(t=>{this.crawlKeyword=t.data})},loadCrawlRuleData(){this.$axios.get("?m=crawler&a=crawlRuleData").then(t=>{this.crawlRule=t.data})},crawlRuleChange(t){this.$axios.post("?m=crawler&a=crawlRuleChange",t).then(()=>{this.loadCrawlRuleData()})},crawlRuleMultiSet(t){this.$axios.post("?m=crawler&a=crawlRuleChange",{autoStart:t}).then(()=>{this.loadCrawlRuleData()})},start_caiji(t){this.caiji.ruleid=t,this.caiji.dialogVisible=!0,this.caiji.source=this.$axios.CancelToken.source(),this.start_auto()},close_caiji(){this.caiji.source.cancel(),this.caiji.result=[]},start_auto(){1==this.caiji.dialogVisible&&this.$axios.get("../crawler/crawlRule?ruleid="+this.caiji.ruleid,{cancelToken:this.caiji.source.token}).then(t=>{t.data.length>0&&this.caiji.result[this.caiji.result.length-1]!=t.data?(this.caiji.result.push(t.data),this.caiji.result.splice(0,this.caiji.result.length-18),-1==t.data.indexOf("Error:")&&setTimeout(()=>{this.start_auto()},200)):setTimeout(()=>{this.start_auto()},2e3)}).catch(t=>{t.data.length>0&&this.caiji.result[this.caiji.result.length-1]!=t.data&&this.caiji.result.push(t.data),-1==t.data.indexOf("Error:")&&setTimeout(()=>{this.start_auto()},500)})},clearRuleLog(){this.$confirm("系统自动对采集进度进行缓存，避免重复采集，只有规则未成功采集，修改规则后才需要清理缓存","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$axios.get("?m=crawler&a=clearRuleLog&id="+this.caiji.ruleid).then(()=>{this.$notify({title:"成功",duration:1e3,message:"缓存已清理",type:"success"})})})},loadAiNewsData(){this.$axios.get("?m=crawler&a=AiNewsData").then(t=>{this.AiNews=t.data})},AiNewsSubmitForm(){this.AiNewsArgs.words?this.AiNewsArgs.siteIds&&0!=this.AiNewsArgs.siteIds.length?this.$confirm("<b>系统将根据标题词汇随机组成的文本插入系统中，文本内容可能存在歧义，您需要自行承担相应后果</b>","使用本功能，表明您已明确了解",{dangerouslyUseHTMLString:!0,confirmButtonText:"开始生成",cancelButtonText:"我不能接受"}).then(()=>{this.AiCaiji.dialogVisible=!0,this.AiNewsSubmitFormHandle()}).catch(()=>{this.$message({message:"已取消生成",type:"warning"})}):this.$message.error("请选择要发布的站点"):this.$message.error("请填写标题词汇")},AiNewsSubmitFormHandle(){this.AiNewsArgs.sites=[],this.AiNews.sites.forEach(t=>{-1!=this.AiNewsArgs.siteIds.indexOf(t.id)&&this.AiNewsArgs.sites.push({id:t.id,class:t.classSeled})});var t=this.AiNewsArgs.words.split("\n"),e={word:t.shift(),titleBetter:this.AiNewsArgs.titleBetter,bodyLength:this.AiNewsArgs.bodyLength,bodyBetter:this.AiNewsArgs.bodyBetter,sites:this.AiNewsArgs.sites};this.$axios.post("?m=crawler&a=AiNewsPost",e).then(e=>{e.data.success&&(this.AiCaiji.result.push(e.data.title),this.AiCaiji.result.splice(0,this.AiCaiji.result.length-18)),this.AiNewsArgs.words=t.join("\n"),this.AiCaiji.dialogVisible&&(t.length>0?t.length>10?this.AiNewsSubmitFormHandle():setTimeout(()=>{this.AiNewsSubmitFormHandle()},500):this.AiCaiji.result.push("<font color=red>生成完成</font>"))})},AiNewsClassSelectionChange(t){this.AiNewsArgs.siteIds=[],t.forEach(t=>{this.AiNewsArgs.siteIds.push(t.id)})},close_AiCaiji(){this.AiCaiji.result=[]}}},se=ee,ae=(s("2078"),Object(u["a"])(se,Wt,Kt,!1,null,"fe2bcd72",null)),ie=ae.exports,le=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/crawler"}},[t._v("采集管理")]),e("el-breadcrumb-item",[t._v("规则编辑")])],1)],1),e("div",{staticClass:"cp-form"},[e("div",{staticClass:"box"},[e("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-position":"top",size:"mini","label-width":"80px"}},[e("el-form-item",{staticClass:"skeleton",attrs:{label:"规则类型",prop:"yuming_id"}},[e("el-radio-group",{attrs:{size:"small"},model:{value:t.form.yuming_id,callback:function(e){t.$set(t.form,"yuming_id",e)},expression:"form.yuming_id"}},[e("el-radio",{attrs:{label:t.siteId,border:""}},[t._v("单站规则")]),e("el-radio",{attrs:{label:"0",border:""}},[t._v("全局规则")])],1)],1),t.form.yuming_id>0?e("el-form-item",{staticClass:"skeleton",attrs:{label:"指定到栏目"}},[e("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.form.class,callback:function(e){t.$set(t.form,"class",e)},expression:"form.class"}},t._l(t.classlist,(function(t){return e("el-option",{key:t.ename,attrs:{label:t.title,value:t.ename}})})),1)],1):t._e(),e("el-form-item",{staticClass:"skeleton",attrs:{label:"列表网址生成"}},[e("el-alert",{attrs:{type:"info",closable:!1}},[t._v(" 要采集的栏目列表，通配符[开始数-结束数]，如：http://example.com/list_[1-10].html ")]),e("el-input",{attrs:{size:"medium",type:"textarea",autosize:{minRows:4},placeholder:"如：http://example.com/list_[1-10].html"},model:{value:t.form.listurl,callback:function(e){t.$set(t.form,"listurl",e)},expression:"form.listurl"}})],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"文章网址区域"}},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:16}},[e("div",{staticClass:"grid-content"},[e("el-alert",{attrs:{type:"info",closable:!1}},[t._v(' 在列表页面找出要采集的文章网址区域，"文章网址前html片段[内容]文章网址后html片段"，"[内容]"为固定占位符 ')]),e("el-input",{attrs:{size:"medium",type:"textarea",autosize:{minRows:4},placeholder:"文章网址前html片段[内容]文章网址后html片段"},model:{value:t.form.articlerule,callback:function(e){t.$set(t.form,"articlerule",e)},expression:"form.articlerule"}})],1)]),e("el-col",{attrs:{span:8}},[e("div",{staticClass:"grid-content"},[e("el-alert",{attrs:{type:"info",closable:!1}},[t._v(" 网址过滤 ")]),e("el-input",{attrs:{size:"medium",type:"textarea",autosize:{minRows:4},placeholder:"多个规则用换行隔开"},model:{value:t.form.norule,callback:function(e){t.$set(t.form,"norule",e)},expression:"form.norule"}})],1)])],1)],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"标题规则"}},[e("el-alert",{attrs:{type:"info",closable:!1}},[t._v(' 在正文页面提取标题，"标题前html片段[内容]标题后html片段"，"[内容]"为固定占位符 ')]),e("el-input",{attrs:{size:"medium",type:"textarea",autosize:{minRows:4},placeholder:"标题前html片段[内容]标题后html片段"},model:{value:t.form.titlerule,callback:function(e){t.$set(t.form,"titlerule",e)},expression:"form.titlerule"}})],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"正文规则"}},[e("el-alert",{attrs:{type:"info",closable:!1}},[t._v(' 在正文页面提取文章内容，"正文前html片段[内容]正文后html片段"，"[内容]"为固定占位符 ')]),e("el-input",{attrs:{size:"medium",type:"textarea",autosize:{minRows:4},placeholder:"正文前html片段[内容]正文后html片段"},model:{value:t.form.contentrule,callback:function(e){t.$set(t.form,"contentrule",e)},expression:"form.contentrule"}})],1),e("el-form-item",{staticClass:"skeleton"},[e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(e){return t.submitForm()}}},[t._v("保存")]),e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(e){return t.testRule()}}},[t._v("测试")])],1)],1)],1)]),e("el-dialog",{attrs:{id:"testRuleDialog",title:"测试规则",width:"80%",visible:t.testRuleVisible,"destroy-on-close":!0},on:{"update:visible":function(e){t.testRuleVisible=e}}},[e("div",{domProps:{innerHTML:t._s(t.testRuleResult)}})])],1)},re=[],oe={mixins:[j],data(){return{form:{},classlist:{},rules:{yuming_id:[{required:!0,message:"请选择规则类型"}]},testRuleVisible:!1,testRuleResult:""}},methods:{pageInit(){if(this.$axios.get("?m=crawler&a=get_classlist").then(t=>{t.data.success&&(this.classlist=t.data.success)}),this.$route.query.id)return new Promise(t=>{this.$axios.get("?m=crawler&a=crawlRuleEdit&id="+this.$route.query.id).then(e=>{e.data.success&&(this.form=e.data.success,t())})})},submitForm(){this.$refs["form"].validate(t=>{t&&this.$axios.post("?m=crawler&a=crawlRuleEdit",this.form)})},testRule(t){this.testRuleResult="",this.testRuleVisible=!0;const e=this.$loading({target:"#testRuleDialog .el-dialog",lock:!0,text:"Loading",spinner:"el-icon-loading"});this.form.testIdx=t||0,this.$axios.post("?m=crawltest",this.form).then(t=>{e.close(),this.testRuleResult=t.data})}}},ne=oe,ce=Object(u["a"])(ne,le,re,!1,null,null,null),ue=ce.exports,de=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/flink"}},[t._v("友情链接")])],1)],1),e("div",{staticClass:"cp-table-top cl"},[e("div",{staticClass:"fl"},[e("el-button",{attrs:{size:"medium",type:"primary",plain:""},on:{click:function(e){return t.routerTo("/flink/edit")}}},[t._v("添加链接")])],1),e("div",{staticClass:"fr skeleton"},[e("form",{attrs:{method:"POST",onsubmit:"return false;"},on:{submit:function(e){return t.routerUpdate({page:null,kw:t.kw})}}},[e("el-input",{attrs:{clearable:"",name:"kw",size:"mini",placeholder:"搜索关键词"},on:{clear:function(e){return t.routerUpdate({page:null,kw:null})}},model:{value:t.kw,callback:function(e){t.kw=e},expression:"kw"}},[e("el-button",{attrs:{slot:"append","native-type":"submit",icon:"el-icon-search"},slot:"append"})],1)],1)])]),e("div",{staticClass:"cp-table skeleton"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.listData}},[e("el-table-column",{attrs:{prop:"id",width:"50",label:"ID"}}),e("el-table-column",{attrs:{prop:"sitename",label:"网站名称"},scopedSlots:t._u([{key:"default",fn:function(s){return[""!=s.row.note?e("el-tooltip",{attrs:{content:s.row.note,placement:"top"}},[e("span",{staticClass:"el-icon-info"},[t._v(" "+t._s(s.row.sitename))])]):e("span",[t._v(t._s(s.row.sitename))])]}}])}),e("el-table-column",{attrs:{prop:"url",label:"网站地址"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.url)+" ")]}}])}),e("el-table-column",{attrs:{prop:"yuming_id",label:"作用范围"},scopedSlots:t._u([{key:"default",fn:function(s){return[s.row.yuming_id>0?e("span",[t._v("当前站点")]):e("span",{staticStyle:{color:"#ccc"}},[t._v("所有站点")])]}}])}),e("el-table-column",{attrs:{prop:"status",label:"status"},scopedSlots:t._u([{key:"default",fn:function(s){return[1==s.row.status?e("el-tag",{attrs:{type:"success",size:"small"}},[t._v("启用")]):t._e(),0==s.row.status?e("el-tag",{attrs:{type:"info",size:"small"}},[t._v("禁用")]):t._e()]}}])}),e("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"list-actions"},[e("span",[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.routerTo("/flink/edit?id="+s.row.id)}}},[t._v("修改")])],1),e("el-popconfirm",{attrs:{title:"确定要删除吗？"},on:{confirm:function(e){return t.ajaxGet("?m=flink&a=del&id="+s.row.id)}}},[e("el-link",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v("删除")])],1)],1)]}}])})],1)],1),e("div",{staticClass:"cp-pages"},[e("el-pagination",{attrs:{"current-page":t.page,"page-size":t.pagesize,"hide-on-single-page":!0,background:"",layout:"prev, pager, next",total:t.total},on:{"current-change":e=>{t.routerUpdate({page:e})}}})],1)])},me=[],pe={mixins:[j],data(){return{kw:"",pagesize:20,total:0,listData:[]}},methods:{pageInit(){return new Promise(t=>{this.kw=this.$route.query.kw,this.$axios.post("?m=flink",{pagesize:this.pagesize,page:this.page,kw:this.kw}).then(e=>{e.data.success&&(this.listData=e.data.success.list,this.total=parseInt(e.data.success.total),t())})})}}},he=pe,fe=Object(u["a"])(he,de,me,!1,null,null,null),be=fe.exports,ge=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/flink"}},[t._v("友情链接")]),e("el-breadcrumb-item",[t._v("链接编辑")])],1)],1),e("div",{staticClass:"cp-form"},[e("div",{staticClass:"box"},[e("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-position":"top","label-width":"80px"}},[e("el-form-item",{staticClass:"skeleton",attrs:{label:"作用范围",prop:"yuming_id"}},[e("el-radio",{attrs:{label:t.siteId},model:{value:t.form.yuming_id,callback:function(e){t.$set(t.form,"yuming_id",e)},expression:"form.yuming_id"}},[t._v("当前站点")]),e("el-radio",{attrs:{label:"0"},model:{value:t.form.yuming_id,callback:function(e){t.$set(t.form,"yuming_id",e)},expression:"form.yuming_id"}},[t._v("所有站点")])],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"网站名称",prop:"sitename"}},[e("el-input",{staticStyle:{width:"300px"},model:{value:t.form.sitename,callback:function(e){t.$set(t.form,"sitename",e)},expression:"form.sitename"}})],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"网站地址",prop:"url"}},[e("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"http://"},model:{value:t.form.url,callback:function(e){t.$set(t.form,"url",e)},expression:"form.url"}}),e("span",{staticClass:"tip"},[t._v("请输入http://开头的网址")])],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"状态"}},[e("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}})],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"备注"}},[e("el-input",{staticStyle:{width:"400px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:t.form.note,callback:function(e){t.$set(t.form,"note",e)},expression:"form.note"}})],1),e("el-form-item",[e("el-button",{staticClass:"skeleton",attrs:{type:"primary",size:"medium"},on:{click:function(e){return t.submitForm(!0)}}},[t._v("保存")])],1)],1)],1)])])},ve=[],we={mixins:[j],data(){return{form:{},rules:{yuming_id:[{required:!0,message:"请选择左右范围",trigger:"change"}],sitename:[{required:!0,message:"请填写网站名称",trigger:"change"}],url:[{required:!0,message:"请填写网站地址",trigger:"change"}]}}},methods:{pageInit(){if(this.$route.query.id)return new Promise(t=>{this.$axios.get("?m=flink&a=edit&id="+this.$route.query.id).then(e=>{e.data.success&&(this.form=e.data.success,t())})})},submitForm(){this.$axios.post("?m=flink&a=edit",this.form)}}},ye=we,_e=Object(u["a"])(ye,ge,ve,!1,null,null,null),ke=_e.exports,xe=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/seo/keyword"}},[t._v("关键词优化")])],1)],1),e("div",{staticClass:"cp-form"},[e("div",{staticClass:"box"},[e("el-form",{ref:"form",attrs:{model:t.form,size:"mini","label-width":"130px"}},[e("el-form-item",{staticClass:"skeleton",attrs:{label:"文章关键词"}},[e("el-input",{staticStyle:{width:"400px"},attrs:{type:"textarea",autosize:{minRows:6,maxRows:10}},model:{value:t.form.seoWord,callback:function(e){t.$set(t.form,"seoWord",e)},expression:"form.seoWord"}}),e("div",{staticClass:"tip"},[t._v("多个关键词用逗号或换行隔开")])],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"同时插入标题"}},[e("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.form.seoTitle,callback:function(e){t.$set(t.form,"seoTitle",e)},expression:"form.seoTitle"}})],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"插入标题位置"}},[e("el-radio",{attrs:{label:"1"},model:{value:t.form.seoTitlex,callback:function(e){t.$set(t.form,"seoTitlex",e)},expression:"form.seoTitlex"}},[t._v("标题前面")]),e("el-radio",{attrs:{label:"2"},model:{value:t.form.seoTitlex,callback:function(e){t.$set(t.form,"seoTitlex",e)},expression:"form.seoTitlex"}},[t._v("标题后面")]),e("el-radio",{attrs:{label:"3"},model:{value:t.form.seoTitlex,callback:function(e){t.$set(t.form,"seoTitlex",e)},expression:"form.seoTitlex"}},[t._v("自由插入")])],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"插入数量"}},[e("el-input-number",{attrs:{"controls-position":"right",min:1,max:10},model:{value:t.form.seoWordNum,callback:function(e){t.$set(t.form,"seoWordNum",e)},expression:"form.seoWordNum"}}),e("div",{staticClass:"tip"},[t._v("每篇文章插入词语的数量")])],1),e("el-form-item",{staticClass:"skeleton",attrs:{label:"文章优化比例"}},[e("el-slider",{staticStyle:{width:"400px"},attrs:{"format-tooltip":t.formatTooltip,step:10},model:{value:t.form.seoWordScale,callback:function(e){t.$set(t.form,"seoWordScale",e)},expression:"form.seoWordScale"}}),e("div",{staticClass:"tip"},[t._v("优化文章的比例，可填0-100，0关闭该功能，100全部文章都插入")])],1),e("el-form-item",[e("el-button",{staticClass:"skeleton",attrs:{type:"primary",size:"medium"},on:{click:function(e){return t.submitForm()}}},[t._v("保存")])],1)],1)],1)])])},Ce=[],Se={mixins:[j],data(){return{form:{}}},methods:{pageInit(){return new Promise(t=>{this.$axios.get("?m=seo&a=keyword&id="+this.$route.query.id).then(e=>{e.data.success&&(this.form=e.data.success,this.form.seoTitlex||this.$set(this.form,"seoTitlex","1"),this.$set(this.form,"seoWordScale",parseInt(this.form.seoWordScale)),t())})})},formatTooltip(t){return 0==t?"关闭":100==t?"全部文章都插入关键词":"每 100 篇文章中处理插入其中 "+t+" 篇"},submitForm(){this.$axios.post("?m=seo&a=keyword",this.form)}}},$e=Se,Te=Object(u["a"])($e,xe,Ce,!1,null,null,null),Ae=Te.exports,Ie=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/seo/reword"}},[t._v("词语替换")])],1)],1),e("div",{staticClass:"cp-table-top cl"},[e("div",[e("el-dropdown",{attrs:{"split-button":"",size:"medium",type:"primary",plain:""},on:{click:function(e){return t.routerTo("/seo/reword/add")},command:t.rewordAdd}},[t._v(" 添加词语 "),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"single"}},[t._v("单个添加")]),e("el-dropdown-item",{attrs:{command:"multi"}},[t._v("批量上传")])],1)],1)],1),e("div",{staticClass:"fr"},[t.listData.length>0?e("el-popconfirm",{attrs:{title:"确定要清空所有吗？"},on:{confirm:function(e){return t.ajaxGet("?m=seo&a=reword_delall")}}},[e("el-button",{attrs:{slot:"reference",type:"info",size:"mini"},slot:"reference"},[t._v("清空所有")])],1):t._e()],1)]),e("div",{staticClass:"cp-table skeleton"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.listData}},[e("el-table-column",{attrs:{prop:"oldword",label:"替换词"}}),e("el-table-column",{attrs:{prop:"type",label:"替换方向"},scopedSlots:t._u([{key:"default",fn:function(s){return[1==s.row.type?e("el-tag",{staticClass:"el-icon-right",attrs:{type:"success",size:"small"}}):t._e(),2==s.row.type?e("el-tag",{attrs:{type:"info",size:"small"}},[e("span",{staticClass:"el-icon-sort",staticStyle:{transform:"rotate(90deg)"}})]):t._e()]}}])}),e("el-table-column",{attrs:{prop:"newword",label:"替换词"}}),e("el-table-column",{attrs:{prop:"yuming_id",label:"作用范围"},scopedSlots:t._u([{key:"default",fn:function(s){return[s.row.yuming_id>0?e("span",[t._v("当前站点")]):e("span",{staticStyle:{color:"#ccc"}},[t._v("所有站点")])]}}])}),e("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-popconfirm",{attrs:{title:"确定要删除吗？"},on:{confirm:function(e){return t.ajaxGet("?m=seo&a=reword_del&id="+s.row.id)}}},[e("el-link",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v("删除")])],1)]}}])})],1)],1),e("div",{staticClass:"cp-pages"},[e("el-pagination",{attrs:{"current-page":t.page,"page-size":t.pagesize,"hide-on-single-page":!0,background:"",layout:"prev, pager, next",total:t.total},on:{"current-change":e=>{t.routerUpdate({page:e})}}})],1),e("el-dialog",{attrs:{title:"上传词语",visible:t.uploadDialogVisible,width:"600px"},on:{"update:visible":function(e){t.uploadDialogVisible=e}}},[e("p",[t._v("1、请上传txt后缀"),e("b",[t._v("UTF-8编码")]),t._v("文件")]),e("p",[t._v("2、替换词必须包含中文，英文字母或者域名可能导致采集异常")]),e("p",[t._v("3、每行一条替换规则，中间用“,”或“->”分隔")]),e("p",[t._v("文件格式下图所示:")]),e("div",{staticStyle:{padding:"8px",border:"dashed 1px #ccc",margin:"5px 0"}},[t._v(" 高兴,开心"),e("br"),t._v(" 伤心,悲伤"),e("br"),t._v(" 友谊->友情"),e("br"),t._v(" 预见->预料"),e("br")]),e("el-form",{attrs:{"label-position":"left",size:"mini","label-width":"80px"}},[e("el-form-item",{attrs:{label:"作用范围"}},[e("el-radio",{attrs:{label:"0"},model:{value:t.upSiteId,callback:function(e){t.upSiteId=e},expression:"upSiteId"}},[t._v("所有站点")]),e("el-radio",{attrs:{label:"{$site[id]}"},model:{value:t.upSiteId,callback:function(e){t.upSiteId=e},expression:"upSiteId"}},[t._v("当前站点")])],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.uploadDialogVisible=!1}}},[t._v("取 消")]),e("el-upload",{staticStyle:{display:"inline"},attrs:{action:"/null","show-file-list":!1,"http-request":t.uploadFile}},[e("el-button",{attrs:{type:"primary"}},[t._v("选择文件")])],1)],1)],1)],1)},ze=[],De={mixins:[j],data(){return{pagesize:20,total:0,listData:[],uploadDialogVisible:!1,upSiteId:"0"}},methods:{pageInit(){return new Promise(t=>{this.kw=this.$route.query.kw,this.$axios.post("?m=seo&a=reword",{pagesize:this.pagesize,page:this.page}).then(e=>{e.data.success&&(this.listData=e.data.success.list,this.total=parseInt(e.data.success.total),t())})})},rewordAdd(t){"single"==t?this.routerTo("/seo/reword/add"):this.uploadDialogVisible=!0},uploadFile(t){let e=new FormData;e.append("file",t.file),this.$axios.post("?m=seo&a=reword_upload&siteId="+this.upSiteId,e,{headers:{"Content-Type":"multipart/form-data;charset=UTF-8"}}).then(()=>{this.pageInit(),this.uploadDialogVisible=!1})}}},Fe=De,Re=Object(u["a"])(Fe,Ie,ze,!1,null,null,null),je=Re.exports,Pe=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/seo/reword"}},[t._v("词语替换")]),e("el-breadcrumb-item",[t._v("词语添加")])],1)],1),e("div",{staticClass:"cp-form"},[e("div",{staticClass:"box"},[e("el-form",{ref:"form",attrs:{model:t.form,"label-position":"top",size:"mini","label-width":"80px"}},[e("el-form-item",{attrs:{label:"作用范围",prop:"yuming_id"}},[e("el-radio",{attrs:{label:"0"},model:{value:t.form.yuming_id,callback:function(e){t.$set(t.form,"yuming_id",e)},expression:"form.yuming_id"}},[t._v("所有站点")]),e("el-radio",{attrs:{label:t.siteId},model:{value:t.form.yuming_id,callback:function(e){t.$set(t.form,"yuming_id",e)},expression:"form.yuming_id"}},[t._v("当前站点")])],1),e("el-form-item",{attrs:{label:"替换词语"}},[e("div",[e("el-input",{staticStyle:{width:"300px"},attrs:{placeHolder:"替换词"},model:{value:t.form.oldword,callback:function(e){t.$set(t.form,"oldword",e)},expression:"form.oldword"}})],1),e("div",{staticStyle:{width:"300px","text-align":"center","line-height":"50px"}},[e("el-button",{staticClass:"el-icon-sort",attrs:{type:"primary",round:"",plain:1==t.form.type},on:{click:function(e){return t.typeChange(2)}}}),e("el-button",{staticClass:"el-icon-bottom",attrs:{type:"primary",round:"",plain:2==t.form.type},on:{click:function(e){return t.typeChange(1)}}})],1),e("div",[e("el-input",{staticStyle:{width:"300px"},attrs:{placeHolder:"替换词"},model:{value:t.form.newword,callback:function(e){t.$set(t.form,"newword",e)},expression:"form.newword"}})],1)]),e("el-form-item",[e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(e){return t.submitForm(!0)}}},[t._v("保存")])],1)],1)],1)])])},Ne=[],Le={mixins:[j],data(){return{form:{yuming_id:"0",type:2}}},methods:{typeChange(t){this.$set(this.form,"type",t)},submitForm(){this.$axios.post("?m=seo&a=reword_add",this.form)}}},qe=Le,Oe=Object(u["a"])(qe,Pe,Ne,!1,null,null,null),Be=Oe.exports,Ve=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/sites"}},[t._v("网站管理")])],1)],1),e("div",{staticClass:"cp-table-top cl"},[e("div",{staticClass:"fl"},[e("el-button",{attrs:{size:"medium",type:"primary",plain:""},on:{click:function(e){return t.routerTo("/sites/edit")}}},[t._v("添加站点")])],1),e("div",{staticClass:"fr skeleton"},[e("form",{attrs:{method:"POST",onsubmit:"return false;"},on:{submit:function(e){return t.routerUpdate({page:null,kw:t.kw})}}},[e("el-input",{attrs:{clearable:"",name:"kw",size:"mini",placeholder:"搜索关键词"},on:{clear:function(e){return t.routerUpdate({page:null,kw:null})}},model:{value:t.kw,callback:function(e){t.kw=e},expression:"kw"}},[e("el-button",{attrs:{slot:"append","native-type":"submit",icon:"el-icon-search"},slot:"append"})],1)],1)])]),e("div",{staticClass:"cp-table skeleton"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.listData}},[e("el-table-column",{attrs:{prop:"id",width:"50",label:"ID"}}),e("el-table-column",{attrs:{prop:"sitename",label:"网站名称"}}),e("el-table-column",{attrs:{prop:"name",label:"域名"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("a",{staticClass:"el-icon-link",attrs:{href:"http://"+s.row.name,target:"_blank"}},[t._v(" "+t._s(s.row.name)+" ")])]}}])}),e("el-table-column",{attrs:{prop:"mobileSwitch",label:"手机版"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-tooltip",{attrs:{content:t.mobileSwitchTip(s.row),placement:"top"}},[e("el-switch",{attrs:{"inactive-value":"0","active-value":"1"},on:{change:function(e){return t.mobileSwitch(s.row,s.$index)}},model:{value:s.row.mobileSwitch,callback:function(e){t.$set(s.row,"mobileSwitch",e)},expression:"scope.row.mobileSwitch"}})],1)]}}])}),e("el-table-column",{attrs:{prop:"template",label:"网站风格"}}),e("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"list-actions"},[e("span",[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.routerTo("/sites/edit?id="+s.row.id)}}},[t._v("修改")])],1),e("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:function(e){return t.siteDel(s.row.id)}}},[e("el-link",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v("删除")])],1)],1)]}}])})],1)],1),e("div",{staticClass:"cp-pages"},[e("el-pagination",{attrs:{"current-page":t.page,"page-size":t.pagesize,"hide-on-single-page":!0,background:"",layout:"prev, pager, next",total:t.total},on:{"current-change":e=>{t.routerUpdate({page:e})}}})],1)])},Ee=[],Ue={mixins:[j],data(){return{kw:"",pagesize:20,total:0,listData:[]}},methods:{pageInit(){return new Promise(t=>{this.kw=this.$route.query.kw,this.$axios.post("?m=sites",{pagesize:this.pagesize,page:this.page,kw:this.kw}).then(e=>{e.data.success&&(this.listData=e.data.success.list,this.total=parseInt(e.data.success.total),t())})})},mobileSwitch(t){this.$axios.post("?m=sites&a=mobileSwitch",t)},mobileSwitchTip:function(t){var e="m."+t.name.replace(/^www\./g,"");return"开启后需将域名 "+e+" 解析到当前服务器IP"},siteDel(t){this.$axios.get("?m=sites&a=del&id="+t).then(async()=>{await this.loadCommon(!0),this.pageInit()})}}},He=Ue,Me=Object(u["a"])(He,Ve,Ee,!1,null,null,null),Ge=Me.exports,We=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/sites"}},[t._v("站点管理")]),e("el-breadcrumb-item",[t._v("站点编辑")])],1)],1),t.is_demo?e("div",{staticStyle:{padding:"10px 0"}},[e("el-alert",{attrs:{type:"error",effect:"dark"}},[e("div",{attrs:{slot:"title"},slot:"title"},[e("div",{staticStyle:{"font-size":"20px"}},[e("i",{staticClass:"el-icon-warning"}),t._v("演示站操作提示")])]),e("div",{attrs:{slot:""},slot:"default"},[e("div",{staticStyle:{"font-size":"16px"}},[t._v(" 1、我们提供的演示子域名供您任意使用，直接添加站点 {随机}.llsq.cn 即可访问测试"),e("br"),t._v(" 2、您也可以把自己的域名（需要已备案）解析到我们到演示服务器ip：113.31.119.240 进行测试"),e("br"),t._v(" 3、测试程序数据仅保留1小时，如需更多测试您可以安装到自己到服务器 ")])])])],1):t._e(),e("div",{staticClass:"cp-form"},[0==t.sitesList.length?e("el-alert",{staticClass:"noSiteTip",attrs:{title:"您的站群还没有网站，现在只需要一分钟，即可创建第一个网站",type:"error",effect:"dark"}}):t._e(),e("el-tabs",{attrs:{type:"border-card"},model:{value:t.tabName,callback:function(e){t.tabName=e},expression:"tabName"}},[e("el-tab-pane",{attrs:{label:"单个网站",name:"single"}},[e("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"120px"}},[e("el-form-item",{attrs:{label:"域名",prop:"name"}},[e("el-space",[e("el-input",{staticStyle:{width:"300px"},attrs:{placeHolder:"网站域名 xxx.com"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),t._v("   "),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"[广告]通过购买有建站历史、有过收录的高权重域名搭建网站，可加快收录排名速度，点击查看",placement:"top"}},[e("a",{staticStyle:{color:"gray"},attrs:{href:"https://www.juming.com/?tt=124097",target:"_blank",rel:"noopener noreferrer"}},[t._v("高权重老域名抢注通道")])])],1)],1),e("el-form-item",{attrs:{label:"网站名称",prop:"sitename"}},[e("el-input",{staticStyle:{width:"300px"},model:{value:t.form.sitename,callback:function(e){t.$set(t.form,"sitename",e)},expression:"form.sitename"}})],1),e("el-form-item",{attrs:{label:"首页标题"}},[e("el-input",{staticStyle:{width:"400px"},attrs:{placeHolder:"浏览器标题栏title标签中，如 xxx网-专业提供xxx服务"},model:{value:t.form.siteTitle,callback:function(e){t.$set(t.form,"siteTitle",e)},expression:"form.siteTitle"}}),e("span",{staticClass:"tip"})],1),e("el-form-item",{attrs:{label:"站点LOGO"}},[t.form.logo?e("ul",{staticClass:"el-upload-list el-upload-list--picture-card"},[e("li",{staticClass:"el-upload-list__item",staticStyle:{height:"auto"}},[e("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:t.$baseHost+t.form.logo}}),e("span",{staticClass:"el-upload-list__item-actions"},[e("span",{staticClass:"el-upload-list__item-delete",on:{click:t.removeThumb}},[e("i",{staticClass:"el-icon-delete"})])])])]):e("el-upload",{attrs:{"list-type":"picture-card",action:"/null","http-request":t.uploadFile,"show-file-list":!1}},[e("i",{staticClass:"el-icon-plus"})]),e("span",{staticClass:"tip"},[t._v("请注意控制图片大小")])],1),e("el-form-item",{attrs:{label:"关键词"}},[e("el-input",{staticStyle:{width:"400px"},model:{value:t.form.keywords,callback:function(e){t.$set(t.form,"keywords",e)},expression:"form.keywords"}})],1),e("el-form-item",{attrs:{label:"描述"}},[e("el-input",{staticStyle:{width:"400px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),e("el-form-item",{attrs:{label:"网站风格",prop:"template"}},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.template,callback:function(e){t.$set(t.form,"template",e)},expression:"form.template"}},t._l(t.themes,(function(t,s){return e("el-option",{key:s,attrs:{label:t.name+"("+s+")",value:s}})})),1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(e){return t.submitForm(!0)}}},[t._v("保存")])],1)],1)],1),this.form.id?t._e():e("el-tab-pane",{attrs:{label:"批量添加",name:"multi"}},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.multiForm,"tooltip-effect":"dark"}},[e("el-table-column",{attrs:{label:"域名"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-input",{model:{value:s.row.name,callback:function(e){t.$set(s.row,"name",e)},expression:"scope.row.name"}})]}}],null,!1,3360424494)}),e("el-table-column",{attrs:{label:"网站名称"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-input",{model:{value:s.row.sitename,callback:function(e){t.$set(s.row,"sitename",e)},expression:"scope.row.sitename"}})]}}],null,!1,4090390117)}),e("el-table-column",{attrs:{label:"首页标题"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-input",{model:{value:s.row.siteTitle,callback:function(e){t.$set(s.row,"siteTitle",e)},expression:"scope.row.siteTitle"}})]}}],null,!1,1525343362)}),e("el-table-column",{attrs:{label:"关键词"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-input",{model:{value:s.row.keywords,callback:function(e){t.$set(s.row,"keywords",e)},expression:"scope.row.keywords"}})]}}],null,!1,2516845315)}),e("el-table-column",{attrs:{label:"描述"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-input",{model:{value:s.row.description,callback:function(e){t.$set(s.row,"description",e)},expression:"scope.row.description"}})]}}],null,!1,2107575407)}),e("el-table-column",{attrs:{label:"网站风格"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-select",{attrs:{placeholder:"请选择"},model:{value:s.row.template,callback:function(e){t.$set(s.row,"template",e)},expression:"scope.row.template"}},t._l(t.themes,(function(t,s){return e("el-option",{key:s,attrs:{label:t.name+"("+s+")",value:s}})})),1)]}}],null,!1,2336084377)}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(s){return[t.multiForm.length>1?e("el-button",{staticClass:"el-icon-delete",attrs:{type:"primary",size:"medium",circle:""},on:{click:function(e){return t.multiRowDel(s.$index)}}}):t._e(),s.$index==t.multiForm.length-1?e("el-button",{staticClass:"el-icon-plus",attrs:{type:"primary",size:"medium",circle:""},on:{click:t.multiRowAdd}}):t._e()]}}],null,!1,415215118)})],1),e("el-divider",{attrs:{"content-position":"left"}},[t._v(" 模版提交（一行一个） ")]),e("el-input",{attrs:{type:"textarea",rows:10,placeholder:"域名#网站名称#首页标题#关键词#描述#网站风格"},model:{value:t.multiTxt,callback:function(e){t.multiTxt=e},expression:"multiTxt"}}),e("div",{staticClass:"box-column"},[t.multiTxt?e("el-button",{attrs:{type:"danger",size:"medium"},on:{click:t.multiTxtHandle}},[t._v("识别模版数据")]):e("el-button",{attrs:{type:"primary",size:"medium",loading:t.loading},on:{click:t.multiSaveHandle}},[t._v("立即创建")])],1)],1)],1)],1)])},Ke=[],Ye={mixins:[j],data(){return{form:{},themes:[],rules:{name:[{required:!0,message:"请填写网站域名",trigger:"change"}],sitename:[{required:!0,message:"请填写网站名称",trigger:"change"}],template:[{required:!0,message:"请选择网站模版",trigger:"change"}]},multiForm:[{},{},{}],multiTxt:"",loading:!1}},computed:{is_demo(){return window.location.host.match(/\.llsq\.cn$/i)},tabName:{get:function(){return this.$route.query.tab?this.$route.query.tab:"single"},set:function(t){this.routerUpdate({tab:t})}}},watch:{multiForm(t){0==t.length&&(this.multiForm=[{}])}},methods:{pageInit(){if(this.$axios.get("?m=sites&a=get_themes").then(t=>{t.data.success&&(this.themes=t.data.success)}),this.$route.query.id)return new Promise(t=>{this.$axios.get("?m=sites&a=edit&id="+this.$route.query.id).then(e=>{e.data.success&&(this.form=e.data.success,t())})})},submitForm(){this.$refs["form"].validate(t=>{t&&this.$axios.post("?m=sites&a=edit",this.form).then(async t=>{t.data.success&&(await this.loadCommon(!0),this.routerTo("/sites"))})})},uploadFile(t){let e=new FormData;e.append("file",t.file),this.$axios.post("?m=upload",e,{headers:{"Content-Type":"multipart/form-data;charset=UTF-8"}}).then(t=>{this.$set(this.form,"logo",t.data.success.location)})},removeThumb(){this.$set(this.form,"logo","")},multiTxtHandle(){this.multiTxt.split("\n").forEach(t=>{var e=t.split("#");this.multiForm.push({name:e[0],sitename:e[1],siteTitle:e[2],keywords:e[3],description:e[4],template:e[5]})}),this.multiTxt=""},multiSaveHandle(){this.loading=!0;var t={data:this.multiForm};this.$axios.post("?m=sites&a=multiSave",t).then(async t=>{this.loading=!1;var e=[];t.data.success&&(this.multiForm.forEach((s,a)=>{-1==t.data.success.successIndexs.indexOf(a)&&e.push(s)}),this.multiForm=e,this.$message({message:"完成"+t.data.success.successIndexs.length+"，失败"+t.data.success.errorIndexs.length+"，请检查",type:"warning"}),await this.loadCommon(!0),this.routerTo("/sites"))})},multiRowDel(t){this.multiForm.splice(t,1)},multiRowAdd(){this.multiForm.push({})}}},Je=Ye,Qe=(s("dc63"),Object(u["a"])(Je,We,Ke,!1,null,"0afcd0d2",null)),Xe=Qe.exports,Ze=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/spider"}},[t._v("爬虫统计")])],1)],1),e("div",{staticClass:"cp-table"},[e("el-tabs",{attrs:{type:"card"},model:{value:t.tabName,callback:function(e){t.tabName=e},expression:"tabName"}},[e("el-tab-pane",{attrs:{label:"爬虫趋势",name:"index"}},[e("div",{staticStyle:{height:"400px"},attrs:{id:"charts"}})]),e("el-tab-pane",{attrs:{label:"详细记录",name:"log"}},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.listData}},[e("el-table-column",{attrs:{prop:"spider",label:"爬虫",width:"200"}}),e("el-table-column",{attrs:{prop:"addtime",label:"抓取时间",width:"200",formatter:e=>t.formatTime(e.addtime)}}),e("el-table-column",{attrs:{prop:"url",label:"抓取链接"}}),e("el-table-column",{attrs:{prop:"ip",label:"IP地址",width:"150"}}),e("el-table-column",{attrs:{prop:"ua",label:"爬虫UA"}})],1),e("div",{staticClass:"cp-pages"},[e("el-pagination",{attrs:{"current-page":t.page,"page-size":t.pagesize,"hide-on-single-page":!0,background:"",layout:"prev, pager, next",total:t.total},on:{"current-change":e=>{t.routerUpdate({page:e})}}})],1)],1)],1)],1)])},ts=[],es={mixins:[j],data(){return{echartsTimer:null,xAxis:[],series:[],pagesize:20,total:0,listData:[]}},computed:{tabName:{get:function(){return this.$route.query.tab?this.$route.query.tab:"index"},set:function(t){this.routerUpdate({tab:t})}}},methods:{pageInit(){"index"==this.tabName?this.$axios.post("?m=spider").then(t=>{t.data.success&&(this.xAxis=t.data.success.xAxis,this.series=t.data.success.series,clearInterval(this.echartsTimer),this.echartsTimer=setInterval(()=>{window.echarts&&(this.echartsLoad(),clearInterval(this.echartsTimer))},100))}):"log"==this.tabName&&this.$axios.post("?m=spider&a=log",{pagesize:this.pagesize,page:this.page}).then(t=>{t.data.success&&(this.listData=t.data.success.list,this.total=parseInt(t.data.success.total))})},echartsLoad(){var t={tooltip:{trigger:"axis"},legend:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:this.xAxis},yAxis:{type:"value"},series:this.series};window.echarts.init(document.getElementById("charts")).setOption(t)}}},ss=es,as=Object(u["a"])(ss,Ze,ts,!1,null,null,null),is=as.exports,ls=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/system/config"}},[t._v("系统配置")])],1)],1),e("div",{staticClass:"cp-form"},[e("div",{staticClass:"box"},[e("el-form",{ref:"form",attrs:{model:t.form,"label-width":"120px"}},[e("el-form-item",{attrs:{label:"网站sitemap"}},[e("el-switch",{attrs:{"active-value":"1","inactive-value":"2"},model:{value:t.form.sitemap,callback:function(e){t.$set(t.form,"sitemap",e)},expression:"form.sitemap"}}),e("div",{staticClass:"tip"},[t._v(" 可提交到 "),e("a",{attrs:{target:"_blank",href:"https://ziyuan.baidu.com/linksubmit/index"}},[t._v("百度站长")]),t._v("，sitemap地址：http://www.example.com/sitemap.xml ")])],1),e("el-form-item",{attrs:{label:"爬虫统计"}},[e("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.form.spider,callback:function(e){t.$set(t.form,"spider",e)},expression:"form.spider"}}),e("div",{staticClass:"tip"},[t._v("开启后，可在“其他管理”->“"),e("router-link",{attrs:{to:"/spider"}},[t._v("爬虫统计")]),t._v("”里查看")],1)],1),e("el-form-item",{attrs:{label:"图片处理"}},[e("el-radio",{attrs:{label:"1"},model:{value:t.form.downPicture,callback:function(e){t.$set(t.form,"downPicture",e)},expression:"form.downPicture"}},[t._v("本地图片")]),e("el-radio",{attrs:{label:"2"},model:{value:t.form.downPicture,callback:function(e){t.$set(t.form,"downPicture",e)},expression:"form.downPicture"}},[t._v("远程图片")]),e("el-radio",{attrs:{label:"0"},model:{value:t.form.downPicture,callback:function(e){t.$set(t.form,"downPicture",e)},expression:"form.downPicture"}},[t._v("过滤图片")])],1),e("el-form-item",{attrs:{label:"百度推送Token"}},[e("el-input",{staticStyle:{width:"200px"},model:{value:t.form.baidu_tui_token,callback:function(e){t.$set(t.form,"baidu_tui_token",e)},expression:"form.baidu_tui_token"}}),e("div",{staticClass:"tip"},[t._v(" 留空则不推送，请到百度站长后台获取 "),e("a",{attrs:{target:"_blank",href:"https://ziyuan.baidu.com/linksubmit/index"}},[t._v("https://ziyuan.baidu.com/linksubmit/index")])])],1),e("el-form-item",{attrs:{label:"自动采集速度"}},[e("el-slider",{staticStyle:{width:"400px"},model:{value:t.form.speed,callback:function(e){t.$set(t.form,"speed",e)},expression:"form.speed"}}),e("div",{staticClass:"tip"},[t._v("越大采集越快，更改设置后两个小时生效")])],1),e("el-form-item",{attrs:{label:"全局嵌入代码"}},[e("el-input",{staticStyle:{width:"600px"},attrs:{type:"textarea",autosize:{minRows:6,maxRows:20},placeholder:"全局的广告、跳转js代码、统计代码"},model:{value:t.form.site_code,callback:function(e){t.$set(t.form,"site_code",e)},expression:"form.site_code"}}),e("div",{staticClass:"tip"},[e("el-link",{on:{click:t.createRedirect}},[t._v("生成跳转代码")]),t._v("    "),e("el-link",{on:{click:t.createIframe}},[t._v("生成嵌入iframe页面")]),t._v("    "),e("el-link",{on:{click:t.createTongji}},[t._v("生成百度统计代码")]),t._v("    ")],1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary",loading:t.axiosLoading},on:{click:function(e){return t.submitForm()}}},[t._v("保存")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.ajaxGet("?m=system&a=upcache")}}},[t._v("更新缓存")])],1)],1)],1)])])},rs=[],os={mixins:[j],data(){return{form:{}}},methods:{pageInit(){return new Promise(t=>{this.$axios.get("?m=system&a=config").then(e=>{e.data.success&&(e.data.success.speed=parseInt(e.data.success.speed),this.form=e.data.success,t())})})},submitForm(){this.$axios.post("?m=system&a=config",this.form)},createRedirect(){this.$prompt("请输入需要跳转到的目标URL网址","生成跳转代码",{inputPlaceholder:"http://",confirmButtonText:"确定",cancelButtonText:"取消"}).then(({value:t})=>{var e='\x3c!--跳转代码开始--\x3e\n<script>(function () { setTimeout(function(){window.location.href = "'+t+'";}, 1000) })();<\/script>\n\x3c!--跳转代码结束--\x3e';this.$set(this.form,"site_code",this.form.site_code+e+"\n\n")})},createIframe(){this.$prompt("请输入需要嵌入到URL网址","生成嵌入iframe页面",{inputPlaceholder:"http://",confirmButtonText:"确定",cancelButtonText:"取消"}).then(({value:t})=>{var e='\x3c!--iframe代码开始--\x3e\n<script>(function () {document.body.style.overflow="hidden";var ifr = document.createElement("iframe"); ifr.src = "'+t+'"; ifr.style="z-index:99999999;position:fixed;display:block;height:100vh;width:100vw;background:#FFF;"; var first=document.body.firstChild; document.body.insertBefore(ifr,first); })();<\/script>\n\x3c!--iframe代码结束--\x3e';this.$set(this.form,"site_code",this.form.site_code+e+"\n\n")})},createTongji(){this.$prompt("百度统计站点ID","生成百度统计代码",{inputPlaceholder:"一段32位长度的字符串",confirmButtonText:"确定",cancelButtonText:"取消"}).then(({value:t})=>{var e='\x3c!--统计代码开始--\x3e\n<script>var _hmt = _hmt || []; (function () { var hm = document.createElement("script"); hm.src = "https://hm.baidu.com/hm.js?'+t+'"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })();<\/script>\n\x3c!--统计代码结束--\x3e';this.$set(this.form,"site_code",this.form.site_code+e+"\n\n")})}}},ns=os,cs=Object(u["a"])(ns,ls,rs,!1,null,null,null),us=cs.exports,ds=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/tags"}},[t._v("标签管理")])],1)],1),e("div",{staticClass:"cp-table-top cl"},[e("div",{staticClass:"fr skeleton"},[e("form",{attrs:{method:"POST",onsubmit:"return false;"},on:{submit:function(e){return t.routerUpdate({page:null,kw:t.kw})}}},[e("el-input",{attrs:{clearable:"",name:"kw",size:"mini",placeholder:"搜索关键词"},on:{clear:function(e){return t.routerUpdate({page:null,kw:null})}},model:{value:t.kw,callback:function(e){t.kw=e},expression:"kw"}},[e("el-button",{attrs:{slot:"append","native-type":"submit",icon:"el-icon-search"},slot:"append"})],1)],1)])]),e("div",{staticClass:"cp-table skeleton"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.listData}},[e("el-table-column",{attrs:{prop:"tagsname",width:"150",label:"标签"}}),e("el-table-column",{attrs:{prop:"num",label:"被引用数"}}),e("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:function(e){return t.ajaxGet("?m=tags&a=del&id="+s.row.id)}}},[e("el-link",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v("删除")])],1)]}}])})],1)],1),e("div",{staticClass:"cp-pages"},[e("el-pagination",{attrs:{"current-page":t.page,"page-size":t.pagesize,"hide-on-single-page":!0,background:"",layout:"prev, pager, next",total:t.total},on:{"current-change":e=>{t.routerUpdate({page:e})}}})],1)])},ms=[],ps={mixins:[j],data(){return{kw:"",pagesize:20,total:0,listData:[]}},methods:{pageInit(){return new Promise(t=>{this.kw=this.$route.query.kw,this.$axios.post("?m=tags",{pagesize:this.pagesize,page:this.page,kw:this.kw}).then(e=>{e.data.success&&(this.listData=e.data.success.list,this.total=parseInt(e.data.success.total),t())})})}}},hs=ps,fs=Object(u["a"])(hs,ds,ms,!1,null,null,null),bs=fs.exports,gs=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/theme"}},[t._v("模版风格")])],1)],1),e("div",{staticClass:"themes"},[e("el-tabs",{attrs:{"tab-position":"left",value:"list","before-leave":t.beforeLeave}},[e("el-tab-pane",{attrs:{label:"我的模版",name:"list"}},[e("div",{staticClass:"wswrap"},t._l(t.listData,(function(s,a){return e("div",{key:a,staticClass:"ws"},[e("div",{staticClass:"preview"},[s.preview?e("img",{attrs:{src:t.$baseHost+s.preview,alt:""}}):e("i",{staticClass:"nopic el-icon-picture-outline"}),e("div",{staticClass:"tplname"},[t._v(t._s(s.name)+"("+t._s(a)+")")]),e("div",{staticClass:"actions"},[e("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini"},on:{click:function(e){return t.showEditorDialog(a,s)}}},[t._v("编辑模版")]),"default"!=a?e("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:function(e){return t.themeDel(a,s)}}},[e("el-button",{staticClass:"el-icon-delete",attrs:{slot:"reference",size:"mini"},slot:"reference"},[t._v("删除模版")])],1):t._e()],1)])])})),0)]),e("el-tab-pane",{attrs:{label:"更多模版",name:"more"}})],1)],1),e("el-dialog",{attrs:{"lock-scroll":!0,"custom-class":"editorDialog",title:t.theme.name+" (/templates/"+t.themeFolder+")",width:"94%",top:"5vh",visible:t.editorDialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":!0},on:{"update:visible":function(e){t.editorDialogVisible=e}}},[t.editorDialogVisible?e("div",{staticClass:"editorWrap"},[e("div",{staticClass:"editorSide"},[e("div",{staticClass:"estitle"},[t._v("模版列表")]),e("div",{staticClass:"treewrap"},[e("el-tree",{ref:"tplTree",attrs:{props:{label:"label",children:"children",isLeaf:"isfile"},load:t.loadtplTree,"highlight-current":!0,"node-key":"dir",lazy:""},on:{"current-change":t.loadTplBody}})],1)]),e("div",{staticClass:"codeEditorWrap"},[e("el-input",{attrs:{size:"small"},model:{value:t.tplDir,callback:function(e){t.tplDir=e},expression:"tplDir"}},[e("template",{slot:"prepend"},[t._v("/templates")])],2),e("codeEditor",{staticClass:"codeEditor",attrs:{fileType:t.fileType},model:{value:t.body,callback:function(e){t.body=e},expression:"body"}})],1)]):t._e(),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.editorDialogVisible=!1}}},[t._v("关 闭")]),t.isText?e("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.saveTpl}},[t._v("保 存")]):t._e()],1)]),e("el-dialog",{attrs:{title:"模版下载中","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,visible:t.downDialogVisible,width:"30%"},on:{"update:visible":function(e){t.downDialogVisible=e}}},[e("div",[e("el-progress",{attrs:{percentage:t.downprogress}})],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.downDialogVisible=!1}}},[t._v("关闭")])],1)])],1)},vs=[],ws=function(){var t=this,e=t._self._c;return e("div",[e("div",{attrs:{id:"monacoEditor"}},[t.isText?t._e():e("div",{staticClass:"imageViewer"},["image"==t.language?e("el-image",{attrs:{src:t.$baseHost+t.value}}):t._e(),"unknow"==t.language?e("span",[t._v("无法显示此文件")]):t._e()],1)])])},ys=[],_s={name:"codeEditor",props:{value:{type:String,default:""},fileType:{type:String,default:""}},data(){return{createTimer:null,resizeTimer:null,editor:null,body:""}},computed:{language(){let t="";switch(this.fileType){case"htm":case"html":case"xml":t="html";break;case"css":t="css";break;case"js":t="javascript";break;case"sql":t="sql";break;case"gif":case"jpg":case"jpeg":case"png":t="image";break;default:t="unknow"}return t},isText(){let t=["html","css","javascript","sql"];return t.indexOf(this.language)>-1}},watch:{language(){this.isText?this.createEditor():this.unloadEditor()},value(t){t!=this.body&&(this.body=t,this.isText&&this.editor.setValue(t))}},mounted(){window.onresize=()=>{this.editor&&(this.resizeTimer=setTimeout(()=>{this.createEditor(),clearTimeout(this.resizeTimer)},1e3))},this.createEditor()},methods:{createEditor(){window.monaco?(clearTimeout(this.createTimer),this.unloadEditor(),this.editor=window.monaco.editor.create(document.getElementById("monacoEditor"),{value:this.body,language:this.language,automaticLayout:!0,autoIndent:!0,minimap:{enabled:!1},lineNumbers:!1}),this.editor.onDidChangeModelContent(()=>{this.body=this.editor.getValue(),this.$emit("input",this.body)})):this.createTimer=setTimeout(()=>{this.createEditor()},100)},unloadEditor(){this.editor&&(this.editor.dispose(),this.editor=null)}}},ks=_s,xs=(s("d6e5"),Object(u["a"])(ks,ws,ys,!1,null,"3e0a7ef6",null)),Cs=xs.exports,Ss={mixins:[j],components:{codeEditor:Cs},data(){return{editorDialogVisible:!1,pagesize:20,total:0,listData:{},liveData:[],themeFolder:"",theme:{},tplDir:"",body:"",fileType:"",loading:!1,downDialogVisible:!1,downprogress:0}},computed:{isText(){var t=["htm","html","xml","css","js","txt"];return-1!=t.indexOf(this.fileType)}},methods:{pageInit(){this.$axios.get("?m=theme").then(t=>{this.listData=t.data.success})},showEditorDialog(t,e){this.themeFolder=t,this.theme=e,this.editorDialogVisible=!0},loadtplTree(t,e){var s=t.level>0?t.data.dir:"/"+this.themeFolder;this.$axios.post("?m=theme&a=loadDir",{dir:s}).then(a=>{if(e(a.data),0===t.level){this.$refs.tplTree.setCurrentKey(s+"/index.htm");var i=this.$refs.tplTree.getCurrentNode();this.loadTplBody(i)}})},loadTplBody(t){if(t.isfile)if(this.tplDir=t.dir,this.fileType=t.dir.substring(t.dir.lastIndexOf(".")+1),this.isText){var e=this.$loading({target:".codeEditor"});this.$axios.post("?m=theme&a=loadTplBody",{file:t.dir}).then(t=>{this.body=t.data.success,e.close()})}else this.body="/templates"+this.tplDir},saveTpl(){this.loading=!0,this.$axios.post("?m=theme&a=tplSave",{theme:this.themeFolder,file:this.tplDir,body:this.body}).then(()=>{this.loading=!1})},themeDel(t){this.$axios.post("?m=theme&a=del",{themeName:t}).then(()=>{this.pageInit()})},beforeLeave(t){return"more"==t&&window.open("https://support.qq.com/products/417911"),!1}}},$s=Ss,Ts=Object(u["a"])($s,gs,vs,!1,null,null,null),As=Ts.exports,Is=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cp-wrap"},[e("div",{staticClass:"crumb",staticStyle:{"border-bottom":"none"}},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{attrs:{to:"/database"}},[t._v("数据库管理")])],1)],1),e("el-tabs",{attrs:{type:"border-card"},model:{value:t.tabName,callback:function(e){t.tabName=e},expression:"tabName"}},[e("el-tab-pane",{attrs:{label:"数据库备份",name:"backup"}},[[e("el-table",{staticStyle:{width:"100%"},attrs:{"show-summary":"","summary-method":t.getSummaries,data:t.tables}},[e("el-table-column",{attrs:{prop:"Name",label:"表",width:"180"}}),e("el-table-column",{attrs:{prop:"Engine",label:"引擎",width:"180"}}),e("el-table-column",{attrs:{prop:"Data_length",label:"数据长度",formatter:t.sizeFormatter}}),e("el-table-column",{attrs:{prop:"Index_length",label:"索引长度",formatter:t.sizeFormatter}}),e("el-table-column",{attrs:{prop:"Data_free",label:"数据空闲",formatter:t.sizeFormatter}}),e("el-table-column",{attrs:{prop:"Auto_increment",label:"自动增量"}}),e("el-table-column",{attrs:{prop:"Rows",label:"行数"}}),e("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"list-actions"},[s.row.Data_free>0?e("span",[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.optimizeTable(s.row.Name)}}},[t._v("优化")])],1):t._e(),e("span",[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.repairTable(s.row.Name)}}},[t._v("修复")])],1)])]}}])})],1),e("div",{staticClass:"cp-table-top"},[e("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.createBackup}},[t._v("创建备份")])],1)]],2),e("el-tab-pane",{attrs:{label:"数据库还原",name:"restore"}},[e("el-card",{staticStyle:{color:"#ff6600"},attrs:{shadow:"hover"}},[e("p",[t._v("1、与程序版本不一致的数据无法还原，请升级前备份好程序，升级后备份好数据库")]),e("p",[t._v("2、数据库备份保存目录为 /data/backup，请您及时下载到本地电脑保存，然后删除服务器上备份文件")]),e("p",[t._v("3、文章正文数据未包含在数据库中，您还需要另行备份"),e("b",[t._v("/data/content")]),t._v("文件夹中的文件")]),e("p",[t._v("4、为了确保安全，请不要将各种压缩包文件放置在网站目录中，包括但不限于整站数据、数据库备份等")])]),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.backupDataList}},[e("el-table-column",{attrs:{prop:"time",label:"备份时间",width:"180",formatter:t=>this.formatTime(t.time)}}),e("el-table-column",{attrs:{prop:"version",width:"180",label:"程序版本"}}),e("el-table-column",{attrs:{prop:"size",label:"备份大小",formatter:t.sizeFormatter}}),e("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(s){return[s.row.status?e("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#67c23a"}},[t._v("已完成")]):t._e(),s.row.status?t._e():e("i",{staticClass:"el-icon-circle-close",staticStyle:{color:"#f56c6c"}},[t._v("未完成")])]}}])}),e("el-table-column",{attrs:{label:"操作",width:"160"},scopedSlots:t._u([{key:"default",fn:function(s){return[s.row.status?e("el-button",{attrs:{slot:"reference",disabled:s.row.version!=t.common.conf.softversion,type:"warning",size:"mini",plain:""},on:{click:function(e){return t.restore(s.row.name)}},slot:"reference"},[t._v("还原")]):t._e(),e("el-button",{attrs:{slot:"reference",type:"danger",size:"mini",plain:""},on:{click:function(e){return t.backupDataDel(s.row.name)}},slot:"reference"},[t._v("删除")])]}}])})],1)],1),e("el-tab-pane",{attrs:{label:"SQL命令行工具",name:"command"}},[e("h3",{staticStyle:{padding:"10px 0"}},[t._v("SQL命令执行工具")]),"command"==t.tabName?e("codeEditor",{staticClass:"sqlEditor",staticStyle:{width:"100%",height:"300px",border:"solid 1px #cccccc"},attrs:{fileType:"sql"},model:{value:t.sqlString,callback:function(e){t.sqlString=e},expression:"sqlString"}}):t._e(),e("div",{staticStyle:{padding:"10px 0"}},[e("el-button",{attrs:{type:"primary"},on:{click:t.runCommand}},[t._v("执行命令")])],1)],1)],1),e("el-dialog",{attrs:{title:"进度",visible:t.progressDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.progressDialogVisible=e}}},[e("el-progress",{attrs:{"text-inside":!0,"stroke-width":22,percentage:t.percentage,status:t.progressStatus}}),e("p",[t._v(t._s(t.message))])],1),e("el-dialog",{attrs:{title:"执行结果",width:"80%",visible:t.commandDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.commandDialogVisible=e}}},t._l(t.execResult,(function(s,a){return e("div",{key:a,staticStyle:{"margin-bottom":"5px"}},[e("el-alert",{attrs:{title:s.success?"执行成功":"执行失败",description:s.sql,type:s.success?"success":"warning",closable:!1}}),s.data?e("el-table",{staticStyle:{width:"100%"},attrs:{data:s.data}},t._l(s.data[0],(function(t,s){return e("el-table-column",{key:s,attrs:{prop:s,label:s}})})),1):t._e()],1)})),0)],1)},zs=[],Ds=(s("404b"),{mixins:[j],components:{codeEditor:Cs},data(){return{tables:[],progressDialogVisible:!1,message:"备份即将开始",param:{},percentage:0,progressStatus:"warning",backupDataList:[],execResult:[],commandDialogVisible:!1,sqlString:""}},computed:{tabName:{get:function(){return this.$route.query.tab?this.$route.query.tab:"backup"},set:function(t){this.routerUpdate({tab:t})}}},methods:{pageInit(){if("backup"==this.tabName)return new Promise(t=>{this.$axios.post("?m=database").then(e=>{this.tables=e.data.success,t()})});"restore"==this.tabName&&this.loadBKList()},sizeFormatter(t,e,s){return this.formatSize(s)},getSummaries(t){const{columns:e,data:s}=t,a=[];return e.forEach((t,e)=>{if(0===e)return void(a[e]="总计");if(1===e||5===e||6===e||7===e)return;const i=s.map(e=>Number(e[t.property]));i.every(t=>isNaN(t))?a[e]="N/A":(a[e]=i.reduce((t,e)=>{const s=Number(e);return isNaN(s)?t:t+e},0),a[e]=this.formatSize(a[e]))}),a},optimizeTable(t){this.$axios.post("?m=database&a=optimize",{table:t}).then(t=>{t.data.success&&this.pageInit()})},repairTable(t){this.$axios.post("?m=database&a=repair",{table:t}).then(t=>{t.data.success&&this.pageInit()})},createBackup(){this.message="备份即将开始",this.param={},this.percentage=0,this.progressStatus="warning",this.progressDialogVisible=!0,this.runBackup()},runBackup(){this.$axios.post("?m=database&a=backup",{param:this.param}).then(t=>{t.data.success?(this.message=t.data.success,this.progressStatus="success",this.percentage=100,setTimeout(()=>{this.progressDialogVisible=!1,this.tabName="restore"},1e3)):(this.param=t.data.param,this.message=t.data.continue,this.percentage=parseInt(t.data.param.sumRow/t.data.param.totalRow*100),this.progressDialogVisible&&this.runBackup())})},restore(t){this.$confirm("您确定要将此次备份还原到数据库吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.message="即将开始数据还原",this.percentage=0,this.progressStatus="success",this.progressDialogVisible=!0,this.runRestore(t)})},runRestore(t){this.$axios.post("?m=database&a=restore",{name:t,siteId:null}).then(e=>{this.percentage=e.data.percentage,e.data.success?(this.message=e.data.success,this.loadCommon(!0),setTimeout(()=>{this.progressDialogVisible=!1},100)):e.data.continue&&(this.message=e.data.continue,this.progressDialogVisible&&setTimeout(()=>{this.runRestore(t)},100))})},loadBKList(){this.$axios.get("?m=database&a=backupDataList").then(t=>{this.backupDataList=t.data.success})},backupDataDel(t){this.$confirm("您确定要删除此次备份数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$axios.get("?m=database&a=backupDataDel",{params:{name:t}}).then(()=>{this.loadBKList()})})},runCommand(){this.$axios.post("?m=database&a=command",{command:this.sqlString}).then(t=>{this.commandDialogVisible=!0,this.execResult=t.data})}}}),Fs=Ds,Rs=Object(u["a"])(Fs,Is,zs,!1,null,null,null),js=Rs.exports;a["default"].use(D["a"]);const Ps=[{path:"/",component:q,meta:{title:"登录"}},{path:"/home",component:G,meta:{title:"系统首页"}},{path:"/admin",component:X,meta:{title:"管理员管理"}},{path:"/admin/edit",component:it,meta:{title:"管理员管理"}},{path:"/ads",component:ut,meta:{title:"广告管理"}},{path:"/ads/edit",component:bt,meta:{title:"广告管理"}},{path:"/article",component:kt,meta:{title:"文章管理"}},{path:"/article/edit",component:jt,meta:{title:"文章管理"}},{path:"/classlist",component:Bt,meta:{title:"栏目管理"}},{path:"/classlist/edit",component:Gt,meta:{title:"栏目管理"}},{path:"/crawler",component:ie,meta:{title:"采集管理"}},{path:"/crawler/edit",component:ue,meta:{title:"采集管理"}},{path:"/flink",component:be,meta:{title:"友情链接管理"}},{path:"/flink/edit",component:ke,meta:{title:"友情链接管理"}},{path:"/seo/keyword",component:Ae,meta:{title:"关键词优化"}},{path:"/seo/reword",component:je,meta:{title:"关键词优化"}},{path:"/seo/reword/add",component:Be,meta:{title:"关键词优化"}},{path:"/sites",component:Ge,meta:{title:"站点管理"}},{path:"/sites/edit",component:Xe,meta:{title:"站点管理"}},{path:"/spider",component:is,meta:{title:"爬虫日志"}},{path:"/system/config",component:us,meta:{title:"系统设置"}},{path:"/tags",component:bs,meta:{title:"标签管理"}},{path:"/theme",component:As,meta:{title:"主题管理"}},{path:"/database",component:js,meta:{title:"数据库管理"}}];var Ns=new D["a"]({routes:Ps});Ns.beforeEach((t,e,s)=>{Ns.app.$options.store.getters.token||"/"===t.path?s():s("/")}),Ns.afterEach(()=>{let t=document.querySelector(".cp-wrap");t&&(t.scrollTop=0)});var Ls,qs=Ns;a["default"].use(C.a),a["default"].prototype.$axios=$.a,a["default"].prototype.$qs=A.a,a["default"].config.productionTip=!1,$.a.defaults.headers["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",a["default"].prototype.$baseHost=null!==(Ls=Object({NODE_ENV:"production",BASE_URL:"/templates/"}).VUE_APP_BASEHOST)&&void 0!==Ls?Ls:"",$.a.defaults.baseURL=a["default"].prototype.$baseHost+(Object({NODE_ENV:"production",BASE_URL:"/templates/"}).VUE_APP_BASEHOST?"/admin/":window.location.pathname),$.a.interceptors.request.use(t=>(z.commit("setAxiosLoading",!0),"multipart/form-data;charset=UTF-8"===t.headers["Content-Type"]?z.getters.siteId&&!Object.prototype.hasOwnProperty.call(t.data,"siteId")&&t.data.append("siteId",z.getters.siteId):(t.data=t.data?t.data:{},"get"==t.method?(t.url+=t.url.indexOf("?")>-1?"&":"?",-1==t.url.indexOf("siteId=")&&z.getters.siteId&&(t.url+="&siteId="+z.getters.siteId)):z.getters.siteId&&!Object.prototype.hasOwnProperty.call(t.data,"siteId")&&(t.data.siteId=z.getters.siteId),t.data=A.a.stringify(t.data)),t),t=>Promise.reject(t)),$.a.interceptors.response.use(t=>(z.commit("setAxiosLoading",!1),200===t.status?(t.data.tip&&C.a.Message({offset:60,message:t.data.tip,type:t.data.success?"success":"error"}),t.data.info&&C.a.Message({offset:60,message:t.data.info,type:"info"}),"noLogin"==t.data.errorType&&(localStorage.removeItem("token"),z.commit("setToken",null)),t.data.redirect&&qs.push({path:t.data.redirect}),Promise.resolve(t)):Promise.reject(t))),new a["default"]({router:qs,store:z,render:t=>t(k)}).$mount("#app")},"77ba":function(t,e,s){},7803:function(t,e,s){},"8bde":function(t,e,s){},"9ad7":function(t,e,s){"use strict";s("7803")},a028:function(t,e,s){"use strict";s("a209")},a209:function(t,e,s){},a357:function(t,e,s){},ac62:function(t,e,s){"use strict";s("f97f")},b430:function(t,e,s){},c7c7:function(t,e,s){"use strict";s("a357")},d6e5:function(t,e,s){"use strict";s("ef2b")},dc63:function(t,e,s){"use strict";s("8bde")},ef2b:function(t,e,s){},f97f:function(t,e,s){}});